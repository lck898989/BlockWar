{"version":3,"sources":["game.js"],"names":["Common","require","cc","Class","extends","Component","properties","prefabArr","default","type","Prefab","girdSize","backPrefab","scoreLabel","Node","nextShape","rivalInfoNode","downButton","next2","slideButton","rotateButton","mask","pauseMenu","pauseBack","pauseContinue","pauseRestart","overMenu","gameSlide","nickName","icon","clickAudio","url","AudioClip","removeAudio","loseAudio","darkNode","handNode","noticePrefab","onLoad","showNoticeHelp","noticeBtn","setPrefabPosition","node","parent","getChildByName","active","invalidRemoveTime","normalSpeed","quickSpeed","up","lr","console","log","director","isPaused","resume","sys","isNative","CC_WECHATGAME","userInfoScript","find","getComponent","Label","string","nameUser","LoadUserPicture","pictureUser","on","bind","totalRemoveTime","totalTime","nodeWidth","width","nodeHeight","height","eliminateCount","score","backGroundArr","time","initMap","nodeArr","createShape","createNext","gameOver","canChangeStatu","iState","xltime","cishu","Array","prototype","contain","shape","undefined","i","length","x","y","playAudio","children","opacity","registerKeyBoard","removeTime","overCost","index","self","nCol","rightDirection","leftDirection","slideStart","invokeRemoveTime","loadScene","leftFunction","moveLeft","rightFunction","moveRight","audioUrl","audioEngine","play","onSlide","onGameSlide","systemEvent","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","event","slidePosition","getLocation","gameSlidePosition","getTouchLine","buttonNode","worldPosition","localX","convertToNodeSpaceAR","v2","n1","Math","floor","n2","keyCode","KEY","down","left","right","f","rotate","onDestroy","off","createRandom","min","max","random","back","row","col","map","tempY","j","outArr","mapData","tempX","tempPrefab","innerNode","prefab","parentNode","trimSizeJson","createPrefab","addChild","prefabNode","instantiate","randomCol","prefabArrTemp","boxColorArr","push","next2Block","nextBlock","generateNext","showNextShape","childrenCount","k","destroy","getNodeArrMaxCol","maxCol","colArr","apply","getNodeArrMinCol","minCol","shareButton","shareFriends","update","dt","column","STATE_COVER","STATE_MENU","STATE_PLAY","STATE_REMOVE","STATE_OVER","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","responseText","open","send","sendData","tag1","updatePrefatY","localStorage","getItem","setItem","stoneTopScore","toString","postMessage","Over","setState","state","isNetWork","CheckIsDown","next","jsonR","removeJsonToServer","removeMapList1","updateMap","n","checkNodeArr","downShine","createMatrix","rows","cols","initial","arr","columns","before0Name","name","before0Type","before0Frame","spriteFrame","before0Row","before1Name","before1Type","before1Frame","before1Row","before2Name","before2Type","before2Frame","before2Row","arguments","jsonData0","color","jsonData1","jsonData2","jsonData3","jsonData4","jsonData5","jsonArr","of","m","jsonMsgToServer","changeMapList1","scheduleOnce","CheckIsLeft","rowArr","leftMove","jsonDataForServer","afterLeftJson","CheckIsRight","rightMove","mr","waitQueue","canRemove","splice","isRemove","addScore","remove","rivalTouchBarry","Promise","resolve","reject","waitDownArr","deleteNodeFromParent","state1","nMapRow","nMapCol","loading1","nDisappear1","waitPromise","setTimeout","isP","then","data","waitQueueLength","addWillDeleteArr","willDeleteArr","typeArr","directorFind","t","direction","directionArr","leftRow","leftCol","isCommonType","nextNode","upFindNodes","tempArr","upNode","shine","downArr","afterRemoveDown","pause"],"mappings":"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","file":"game.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Scripts\\game3","sourcesContent":["var Common = require(\"Common\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        //预制体数组\r\n        prefabArr : {\r\n            default : [],\r\n            type    : [cc.Prefab],\r\n        },\r\n        girdSize : 20,\r\n        backPrefab  : {\r\n            default : null,\r\n            type    : cc.Prefab,\r\n        },\r\n        scoreLabel : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //下一个形状显示区域节点\r\n        nextShape   : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //联网版的时候是对手信息\r\n        rivalInfoNode : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //下落按钮\r\n        downButton  : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //单机版的时候是下下个方格状态\r\n        next2 : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //gameover标签\r\n        // gameBye : {\r\n        //     default : null,\r\n        //     type    : cc.Node,\r\n        // },\r\n        //滑动按钮\r\n        slideButton : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        rotateButton : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //遮罩\r\n        mask : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //暂停结束菜单\r\n        pauseMenu : {\r\n            default   : null,\r\n            type      : cc.Node,\r\n        },\r\n        pauseBack : cc.Node,\r\n        pauseContinue : cc.Node,\r\n        pauseRestart : cc.Node,\r\n        //游戏结束菜单\r\n        overMenu  : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        gameSlide : cc.Node,\r\n        nickName : cc.Node,\r\n        icon     : cc.Node,\r\n        //按钮点击音效\r\n        clickAudio : {\r\n            url : cc.AudioClip,\r\n            default : null,\r\n        },\r\n        //消除音效\r\n        removeAudio : {\r\n            url : cc.AudioClip,\r\n            default : null,\r\n        },\r\n        //失败音效\r\n        loseAudio : {\r\n            url : cc.AudioClip,\r\n            default : null,\r\n        },\r\n        darkNode : cc.Node,\r\n        handNode : cc.Node,\r\n        noticePrefab : cc.Prefab,\r\n    },\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this.showNoticeHelp = true;\r\n        this.noticeBtn = this.setPrefabPosition(this.noticePrefab,0,0,this.node.parent.getChildByName(\"noticeDark\"));\r\n        this.noticeBtn.active = true;\r\n        this.invalidRemoveTime = 0;\r\n        this.normalSpeed = 0.7,\r\n        this.quickSpeed  = 0.07,\r\n        this.up = 10;\r\n        this.lr = 12;\r\n        console.log(\"noticeBtn is \",this.noticeBtn);\r\n        cc.log(\"当前游戏是否是处于暂停状态\"+cc.director.isPaused());\r\n        if(cc.director.isPaused()){\r\n            cc.director.resume();\r\n        }\r\n        if(cc.sys.isNative){\r\n            // var userInfoScript = cc.find(\"PebmanentNode\").getComponent(\"UserInfo\");\r\n            // this.nickName.getComponent(cc.Label).string = userInfoScript.nameUser;\r\n            // userInfoScript.LoadUserPicture(userInfoScript.pictureUser,this.icon);\r\n        }\r\n        if(CC_WECHATGAME){\r\n            var userInfoScript = cc.find(\"PebmanentNode\").getComponent(\"UserInfo\");\r\n            this.nickName.getComponent(cc.Label).string = userInfoScript.nameUser;\r\n            userInfoScript.LoadUserPicture(userInfoScript.pictureUser,this.icon);\r\n        }\r\n        this.noticeBtn.on(\"touchstart\",function(){\r\n            this.darkNode.active = false;\r\n            this.handNode.active = false;\r\n            this.noticeBtn.active =false;\r\n            this.showNoticeHelp = false;\r\n        }.bind(this));\r\n        this.darkNode.on(\"touchstart\",function(){\r\n            this.darkNode.active = false;\r\n            this.handNode.active = false;\r\n            this.noticeBtn.active =false;\r\n            this.showNoticeHelp = false;\r\n        }.bind(this));\r\n        this.handNode.on(\"touchstart\",function(){\r\n            this.darkNode.active = false;\r\n            this.handNode.active = false;\r\n            this.noticeBtn.active =false;\r\n            this.showNoticeHelp = false;\r\n        }.bind(this));\r\n        // Menu.prototype.onLoad();\r\n        // if(Common.MOVEMODEL === 1){\r\n        //     this.slideButton.active = true;\r\n        //     this.leftAndRight.active = false;\r\n        // }else if(Common.MOVEMODEL === 2){\r\n        //     this.slideButton.active = false;\r\n        //     this.leftAndRight.active = true;\r\n        //     //为左右按钮添加点击事件\r\n        // }\r\n        //消除的总次数\r\n        this.totalRemoveTime = 0;\r\n        this.totalTime = 0;\r\n        //消除之后待下落数组的集合\r\n        this.nodeWidth = this.node.width;\r\n        this.nodeHeight = this.node.height;\r\n        cc.log(\"this.nodeWidth is \" + this.nodeWidth + \"this.nodeHeight is \" + this.nodeHeight);\r\n        //定义消除次数\r\n        this.eliminateCount = 0;\r\n        //定义得分\r\n        this.score = 0;\r\n        //背景二位数组\r\n        this.backGroundArr = null;\r\n        //形状集合二维数组,将每次生成的形状添加到二维数组里面\r\n        // this.shapeArr = [];\r\n        this.time = 0;\r\n        //创建背景网格\r\n        this.initMap(this.up,this.lr,this.backPrefab,12,6);\r\n        //存放每次生成的预制体数组即是活动的条\r\n        this.nodeArr = this.createShape(this.node);\r\n        //生成下一个形状\r\n        this.createNext();\r\n        // //显示下一个形状\r\n        // this.showNextShape(this.nextBlock);\r\n        //显示下下个形状\r\n        // this.showNextShape();\r\n        cc.log(\"this.nodeArr is \" + this.nodeArr);\r\n        // this.columnLocation();\r\n        //创建下一个旋转体\r\n        this.gameOver = false;\r\n        // this.nextShape = new Shape(this.nextShape,0,0);\r\n        // this.gameBye.active = false;\r\n        //当前条是否还可以改变状态\r\n        this.canChangeStatu = true;\r\n        //状态机的状态\r\n        this.iState = 0;\r\n        //定义一个状态标志\r\n        /**\r\n         * cover = 0 封面\r\n         * paly = 2; 游戏\r\n         * remove = 3;消除\r\n         * over = 4;结束游戏\r\n         * Menu 菜单\r\n         */\r\n        this.xltime = this.normalSpeed;\r\n        this.cishu = 0;\r\n        Array.prototype.contain = function(shape){\r\n            if(shape != undefined){\r\n                for(var i = 0;i<this.length;i++){\r\n                    if(this[i].x === shape.x && this[i].y === shape.y && this[i].getComponent(\"Stone\").type === shape.getComponent(\"Stone\").type){\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        //下落按钮监听\r\n        this.downButton.on(\"touchstart\",function(){\r\n            this.playAudio(this.clickAudio);\r\n            this.downButton.children[0].opacity = 120;\r\n            this.xltime = this.quickSpeed;\r\n        }.bind(this));\r\n        this.downButton.on(\"touchend\",function(){\r\n            this.downButton.children[0].opacity = 0;\r\n            this.xltime = this.normalSpeed;\r\n        }.bind(this));\r\n        //注册监听事件\r\n        this.registerKeyBoard();\r\n        // var rotateAction = cc.rotateBy(3,360).easing(cc.easeCubicActionOut());\r\n        // var rf = cc.repeatForever(rotateAction);\r\n        // this.rotateButton.runAction(rf);\r\n        //游戏开始不显示遮罩\r\n        this.mask.active = false;\r\n        //开始时候暂停菜单不显示\r\n        this.pauseMenu.active = false;\r\n        //消除的次数\r\n        this.removeTime = 0;\r\n\r\n        //游戏结束菜单不显示\r\n        this.overMenu.active = false;\r\n        //游戏结束计时\r\n        this.overCost = 0;\r\n        //滑动按钮时间间隔，到达那个事件间隔计算第二次触摸所对应的列数\r\n        this.index = 0;\r\n        var self = this;\r\n        //触屏的当前列\r\n        this.nCol = 0;\r\n        this.rightDirection = false;\r\n        this.leftDirection = false;\r\n        this.slideStart = 0;\r\n        this.invokeRemoveTime = 0;\r\n        this.pauseBack.on(\"touchstart\",function(){\r\n            console.log(\"暂停页面退出\");\r\n            cc.director.resume();\r\n            cc.director.loadScene(\"OneChoose\");\r\n            // cc.director.resume();\r\n            // self.mask.active = false;\r\n            // self.pauseMenu.active = false;\r\n            \r\n        }.bind(this));\r\n        this.pauseContinue.on(\"touchstart\",function(){\r\n            console.log(\"暂停页面继续\");\r\n            cc.director.resume();\r\n            self.mask.active = false;\r\n            self.pauseMenu.active = false;\r\n        }.bind(this));\r\n        this.pauseRestart.on(\"touchstart\",function(){\r\n            console.log(\"暂停页面重新开始\");\r\n            cc.director.resume();\r\n            self.mask.active = false;\r\n            self.pauseMenu.active = false;\r\n            cc.director.loadScene(\"Game3\");\r\n        }.bind(this));\r\n    },\r\n    leftFunction : function(){\r\n        this.moveLeft();\r\n    },\r\n    rightFunction : function(){\r\n        this.moveRight();\r\n    },\r\n    playAudio : function(audioUrl){\r\n        cc.audioEngine.play(audioUrl,false,1);\r\n    },\r\n    //注册键盘监听\r\n    registerKeyBoard : function(){\r\n        //是否在滑动节点上\r\n        this.onSlide = false;\r\n        this.onGameSlide = false;\r\n        var self = this;\r\n        //注册键盘监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n        //滑动按钮监听\r\n        this.slideButton.on(\"touchstart\",function(event){\r\n            this.slideButton.children[0].opacity = 120;\r\n            // this.onSlide = true;\r\n            //获得当前点击的全局坐标\r\n            // self.slidePosition = event.getLocation();\r\n            //获得开始触点的坐标\r\n            // this.slideStart = event.getLocation();\r\n            // cc.log(\"self.slidePositionX is \" + self.slidePosition.x);\r\n        }.bind(this));\r\n        //在滑动节点上移动的时候\r\n        this.slideButton.on(\"touchmove\",function(event){\r\n            // if(event.getLocation().x - self.slidePosition.x > 0){\r\n            //     this.rightDirection = true;\r\n            //     cc.log(\"------>>>>>>\");\r\n            // }else if(event.getLocation().x - self.slidePosition.x < 0){\r\n            //     this.leftDirection = true;\r\n            //     cc.log(\"<<<<<-------\");\r\n            // }\r\n            this.slideButton.children[0].opacity = 120;\r\n            this.onSlide = true;\r\n            self.slidePosition = event.getLocation();\r\n            cc.log(\"slidePositionX is \" + self.slidePosition.x);\r\n        }.bind(this));\r\n        //在滑动节点上离开的时候\r\n        this.slideButton.on(\"touchend\",function(event){\r\n            self.slidePosition = event.getLocation();\r\n            this.slideButton.children[0].opacity = 0;\r\n            this.onSlide = true;\r\n        }.bind(this));\r\n        //在滑动节点上离开的时候\r\n        this.slideButton.on(\"touchcancel\",function(event){\r\n            self.slidePosition = event.getLocation();\r\n            this.slideButton.children[0].opacity = 0;\r\n            this.onSlide = false;\r\n        }.bind(this));\r\n        // 滑动节点上方的空节点\r\n        this.gameSlide.on(\"touchstart\",function(event){\r\n            cc.log(\"点击了gameSlide节点\");\r\n        }.bind(this));\r\n        this.gameSlide.on(\"touchmove\",function(event){\r\n            this.onGameSlide = true;\r\n            self.gameSlidePosition = event.getLocation();\r\n        }.bind(this));\r\n        this.gameSlide.on(\"touchend\",function(event){\r\n            this.onGameSlide = true;\r\n            self.gameSlidePosition = event.getLocation();\r\n        }.bind(this));\r\n        this.gameSlide.on(\"touchcancel\",function(event){\r\n            this.onGameSlide = false;\r\n            self.gameSlidePosition = event.getLocation();\r\n        }.bind(this));\r\n    },\r\n    //返回触点对应的列数\r\n    /**\r\n     * @param  {触摸的是哪个节点} buttonNode\r\n     * @param  {世界节点坐标系} worldPosition\r\n     */\r\n    getTouchLine : function(buttonNode,worldPosition){\r\n        //将触点的x坐标转化为本地坐标系\r\n        var localX = buttonNode.convertToNodeSpaceAR(cc.v2(worldPosition.x,worldPosition.y)).x;\r\n        cc.log(\"local is \" + localX);\r\n        if(localX > 0){\r\n             var n1 = Math.floor(localX/(buttonNode.width/6));\r\n             if(n1 >= 0 && n1 < 1){\r\n                this.nCol = 3;\r\n             }else if(n1 >= 1 && n1 < 2){\r\n                 this.nCol = 4;\r\n             }else if(n1 >= 2 && n1 < 3){\r\n                 this.nCol = 5;\r\n             }\r\n        }else if(localX < 0){\r\n            var n2 = Math.floor(-localX/(buttonNode.width/6));\r\n            if(n2 >= 0 && n2 < 1){\r\n               this.nCol = 2;\r\n           }else if(n2 >= 1 && n2 < 2){\r\n               this.nCol = 1;\r\n           }else if(n2 >= 2 && n2 < 3){\r\n               this.nCol = 0;\r\n           }\r\n        }\r\n        if(this.nCol >= 5){\r\n            this.nCol = 5;\r\n        }\r\n        return this.nCol;\r\n   },\r\n    onKeyDown : function(event){\r\n        switch(event.keyCode){\r\n            case cc.KEY.down:\r\n                this.xltime = this.quickSpeed;\r\n                 break;\r\n            case cc.KEY.left:\r\n                 this.moveLeft();\r\n                 cc.log(\"<-----\");\r\n                 break;\r\n            case cc.KEY.right:\r\n                 this.moveRight();\r\n                 cc.log(\"----->\");\r\n                 break;  \r\n            case cc.KEY.f:\r\n                 this.rotate();\r\n                 //旋转操作\r\n                 break;                  \r\n        }\r\n    },\r\n    onKeyUp   : function(event){\r\n        switch(event.keyCode){\r\n            case cc.KEY.down:\r\n                this.xltime = this.normalSpeed;\r\n                 break;\r\n            case cc.KEY.left:\r\n                 break;\r\n            case cc.KEY.right:\r\n                 break;  \r\n            case cc.KEY.f:\r\n                 //旋转操作\r\n                 break;                 \r\n        }\r\n    },\r\n    onDestroy () {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    },\r\n    //产生随机数\r\n    createRandom : function(min,max){\r\n         return Math.floor(Math.random()*(max - min) + min);\r\n    },\r\n    //初始化游戏场景主背景12行6列的网格\r\n    /**\r\n     * @param  {外框上边缘的厚度} up\r\n     * @param  {外框左右边缘的厚度} lr\r\n     * @param  {背景网格的预制体} back\r\n     * @param  {行数} row\r\n     * @param  {列数} col\r\n     */\r\n    initMap : function(up,lr,back,row,col){\r\n        //初始化y坐标\r\n        var y = this.nodeHeight/2 - this.girdSize/2 - up;\r\n        //初始化x坐标\r\n        var x = -this.nodeWidth/2 + this.girdSize/2 + lr;\r\n        cc.log(\"x is \" + x);\r\n        this.backGroundArr = [];\r\n        this.map = [];\r\n        //12行6列的网格\r\n        for(var i = 0;i < row; i++){\r\n            //设置它的y坐标\r\n            var tempY =y - i * this.girdSize;\r\n            cc.log(\"tempY is \" + tempY);\r\n            this.backGroundArr[i] = [];\r\n            this.map[i] = [];\r\n            for(var j = 0; j < col;j++){\r\n                var outArr = this.backGroundArr[i];\r\n                var mapData = this.map[i];\r\n                var tempX = x + j * this.girdSize;\r\n                cc.log(\"tempX is \" + tempX);\r\n                //y坐标不变，x坐标要变\r\n                var tempPrefab = this.setPrefabPosition(back,tempX,tempY,this.node,null);\r\n                // var shape = new Shape(tempPrefab,-1);\r\n                tempPrefab.getComponent(\"Back\").type = -1;\r\n                tempPrefab.getComponent(\"Back\").innerNode = null;\r\n                // var shape = new Shape(tempPrefab,-1);\r\n                outArr[j]=tempPrefab;\r\n                mapData[j] = 0;\r\n            }\r\n        }\r\n        cc.log(\"backGroundArr is \" +this.backGroundArr);\r\n    },\r\n    /**\r\n    @param prefab:将要生成预制节点的预制体\r\n    @param x     :将要生成预制节点的x坐标\r\n    @param y     :将要生成预制节点的y坐标\r\n    @param parentNode : 生成的预制节点的父节点\r\n    @param trimSizeJson : 裁减预制体的json对象\r\n     */\r\n    setPrefabPosition : function(prefab,x,y,parentNode,trimSizeJson){\r\n           var prefab = this.createPrefab(prefab);\r\n           if(trimSizeJson != null){\r\n               prefab.width = trimSizeJson.width;\r\n               prefab.height = trimSizeJson.height;\r\n           }\r\n        //    prefab.setPosition(x,y);\r\n           prefab.x = x;\r\n           prefab.y = y;\r\n           parentNode.addChild(prefab);\r\n           return prefab;\r\n    },\r\n    createPrefab : function(prefab){\r\n        var prefabNode = cc.instantiate(prefab);\r\n        return prefabNode;\r\n    },\r\n    //生成形状每一个节点设置为都为0行随机列\r\n    createShape : function(parentNode){\r\n        //该节点数组消除次数容易计分\r\n        // this.removeTime = 0;\r\n        this.cishu = 0;\r\n        //动态生成一个新的节点将生成的预制体节点加入到该父节点上\r\n        // var newNode = new cc.Node();\r\n        // parentNode.addChild(newNode);\r\n        //用来存放预制体的数组\r\n        var randomCol = this.createRandom(2,4);\r\n        var prefabArrTemp = [];\r\n        //盛放颜色代码的数组每次重新生成预制体节点的时候将之前的颜色代码数组置空\r\n        this.boxColorArr = [];\r\n        for(var i = 0;i < 3;i++){\r\n            // var offSet = i * this.girdSize;\r\n            // cc.log(\"offSet is \" + offSet);\r\n            // //产生0-3的随机数\r\n            var index = this.createRandom(0,4);\r\n\r\n            // //将对应的颜色索引存放到该数组中\r\n            // // this.boxColorArr.push(this.prefabArr[index].color);\r\n            // cc.log(\"index is \" + index);\r\n            // //将对应的预制体取出来转化为节点然后显示\r\n            var prefabNode = this.createPrefab(this.prefabArr[index]);\r\n            var self = this;\r\n            //设置预制节点的位置\r\n            // prefabNode.setPosition(self.backGroundArr[0][randomCol].x,self.backGroundArr[0][randomCol].y);\r\n            prefabNode.x = self.backGroundArr[0][randomCol].x;\r\n            prefabNode.y = self.backGroundArr[0][randomCol].y;\r\n            prefabNode.getComponent(\"Stone\").type = index;\r\n            prefabNode.getComponent(\"Stone\").row = 0;\r\n            prefabNode.getComponent(\"Stone\").col = randomCol;\r\n            prefabNode.active = false;\r\n\r\n            // this.backGroundArr[i][randomCol].innerNode = prefabNode;\r\n            cc.log(\"------type is \" + prefabNode.getComponent(\"Stone\").type);\r\n            //将该预制节点添加为parentNode的孩子\r\n            parentNode.addChild(prefabNode);\r\n            // var shape = new Shape(prefabNode,index);\r\n            //将当前预制体节点存放到预制体临时数组里面\r\n            prefabArrTemp.push(prefabNode);\r\n            // (function(num){\r\n            //     //动态加载图片\r\n            //     function loadImage(){\r\n            //         return new Promise(function(resolve,reject){\r\n            //             cc.loader.loadRes(\"Game3/\"+index.toString(),cc.SpriteFrame,function(err,spriteFrame){\r\n            //                 if(err){\r\n            //                     console.log(\"加载失败\");\r\n            //                     reject();\r\n            //                 }\r\n            //                 resolve(spriteFrame);\r\n            //             })\r\n            //         });\r\n            //     }\r\n            //     loadImage().then(function(spriteFrame){\r\n            //     },function(){\r\n            //         console.log(\"加载失败！！！！！\");\r\n            //     });\r\n            // })(i);\r\n        }\r\n        console.log(prefabArrTemp);\r\n        return prefabArrTemp;\r\n    },\r\n    //生成下一个形状\r\n    createNext : function(){\r\n        if(this.next2Block === undefined){\r\n            this.nextBlock = this.generateNext(this.node);\r\n            //显示下一个形状\r\n            this.showNextShape(this.nextBlock,this.nextShape,null);\r\n        }else{\r\n            this.nextBlock = this.next2Block;\r\n            this.showNextShape(this.nextBlock,this.nextShape,null);\r\n        }\r\n        //生成下下个形状\r\n        this.next2Block = this.generateNext(this.node);\r\n        var trimSizeJson = {\r\n            width      : 100,\r\n            height      : 100,\r\n        }\r\n        //显示下下个形状\r\n        this.showNextShape(this.next2Block,this.next2,trimSizeJson);\r\n    },\r\n    //显示下一个形状\r\n    /**\r\n     * @param  {下一个形状的数组} nextBlock\r\n     * @param  {父节点} parentNode\r\n     * @param  {是否修改预制体节点的大小} TrimSizeJson\r\n     */\r\n    showNextShape : function(nextBlock,parentNode,trimSizeJson){\r\n        //显示下一个形状之前删除这个节点的所有子节点\r\n        if(parentNode.childrenCount > 0){\r\n            for(let k = 0;k<parentNode.childrenCount;k++){\r\n                //销毁该子节点,如果销毁节点成功的话就显示下一个形状\r\n                parentNode.children[k].destroy();\r\n            }\r\n        }\r\n        //依次生成预制节点组成的节点数组\r\n        for(let i = 0;i<3;i++){\r\n            var type = nextBlock[i].getComponent(\"Stone\").type;\r\n            // if(trimSizeJson != null){\r\n            //     this.prefabArr[type].width = trimSizeJson.width;\r\n            //     this.prefabArr[type].height = trimSizeJson.height;\r\n            // }\r\n            // var spriteFrame = nextBlock[i].getComponent(\"cc.Sprite\").spriteFrame;\r\n            if(trimSizeJson === null){\r\n                this.setPrefabPosition(this.prefabArr[type],0,120-i*this.girdSize,parentNode,trimSizeJson);\r\n            }else{\r\n                this.setPrefabPosition(this.prefabArr[type],0,100-i*trimSizeJson.height,parentNode,trimSizeJson);\r\n            }\r\n            \r\n        }\r\n        // for(let k = 0;k<3;k++){\r\n        //     var pre = ;\r\n        //     this.setPrefabPosition(,50,50+k*this.girdSize,this.nextShape);\r\n        // }\r\n    },\r\n    getNodeArrMaxCol : function(){\r\n        var maxCol;\r\n        var colArr = [];\r\n        for(let i = 0;i<this.nodeArr.length;i++){\r\n            colArr.push(this.nodeArr[i].getComponent(\"Stone\").col);\r\n        }\r\n        maxCol = Math.max.apply(Math,colArr);\r\n        //返回最大列\r\n        return maxCol;\r\n    },\r\n    getNodeArrMinCol : function(){\r\n        var minCol;\r\n        var colArr = [];\r\n        for(let i = 0;i<this.nodeArr.length;i++){\r\n            colArr.push(this.nodeArr[i].getComponent(\"Stone\").col);\r\n        }\r\n        minCol = Math.min.apply(Math,colArr);\r\n        //返回最小列\r\n        return minCol;\r\n    },\r\n    shareButton : function(){\r\n        if(CC_WECHATGAME){\r\n            console.log(\"首页share\");\r\n            cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").shareFriends();\r\n        }else if(cc.sys.isNative){\r\n            //原生平台分享\r\n            // cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").nativeShare();\r\n        }\r\n    },\r\n    // called every frame\r\n    update: function (dt) {\r\n        if(this.showNoticeHelp){\r\n            return;\r\n        }else{\r\n            if(this.onSlide || this.onGameSlide){\r\n                this.index += dt;\r\n                // cc.log(\"this.slidePosition is \" + this.slidePosition.x);\r\n                // if(this.index === dt){\r\n                //     this.column1 = this.getTouchLine(this.slidePosition);\r\n                // }\r\n                // if(this.index >= 0.3){\r\n                //     this.column2 = this.getTouchLine(this.slidePosition);\r\n                //     this.index = 0;\r\n                // }\r\n                if(this.onSlide){\r\n                    var column = this.getTouchLine(this.slideButton,this.slidePosition);\r\n                    //当用的是滑屏的时候将空节点的滑动状态改为false\r\n                    this.onSlide = false;\r\n                }else{\r\n                    var column = this.getTouchLine(this.gameSlide,this.gameSlidePosition);\r\n                    this.onGameSlide = false;\r\n                }\r\n                //如果当前列比节点数组中最大列还大的话就右移\r\n                if(column > this.getNodeArrMaxCol()){\r\n                    //右移\r\n                    this.moveRight();\r\n                }else if(column < this.getNodeArrMinCol()){\r\n                    //左移\r\n                    this.moveLeft();\r\n                }\r\n            }\r\n            switch(this.iState){\r\n                case Common.STATE_COVER:\r\n                    //执行封面\r\n                case Common.STATE_MENU:\r\n                    //菜单\r\n                case Common.STATE_PLAY:\r\n                    //游戏 --执行游戏代码\r\n                case Common.STATE_REMOVE:\r\n                   //消除 -- 执行消除代码\r\n                case Common.STATE_OVER:\r\n                  //游戏结束 -- 执行游戏结束代码\r\n            }\r\n            //如果游戏结束了就不在进行下落\r\n            if(!this.gameOver){\r\n                this.invalidRemoveTime += dt;\r\n                //告诉服务器不要断开连接\r\n                if(this.invalidRemoveTime >= 60){\r\n                    console.log(\"发送给服务器消息防止自己不被踢出\");\r\n                    var url = 'https://m5.ykplay.com/KeepLink';\r\n                    var xhr = new XMLHttpRequest();\r\n                    xhr.onreadystatechange = function () {\r\n                        if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                            var response = xhr.responseText;\r\n                            console.log(response);\r\n                        }\r\n                    };\r\n                    xhr.open(\"GET\", url, true);\r\n                    xhr.send();\r\n                    //发送长连接请求\r\n                    if(cc.sys.isNative || (CC_WECHATGAME)){\r\n                        var sendData = {\r\n                            tag1 : 0,\r\n                            score : \"\",\r\n                            type : \"\"\r\n                        }\r\n                        // var dataString = JSON.stringify(sendData);\r\n                        // console.log(\"dataString is \",dataString);\r\n                        // cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(sendData);\r\n                    }\r\n                    this.invalidRemoveTime = 0;\r\n                }\r\n                this.time += dt;\r\n                if(this.cishu === 0 && this.xltime < this.normalSpeed){\r\n                    //如果重新生成一个形状的话就将下落的速度改为this.normalSpeed\r\n                    this.xltime = this.normalSpeed;\r\n                }\r\n                if(this.totalTime === 3){\r\n                    if(this.totalRemoveTime <= 17){\r\n                        //将下落速度提升\r\n                        this.normalSpeed -= 0.1;\r\n                    }\r\n                    this.totalTime = 0;\r\n                }\r\n                if(this.time > this.xltime){\r\n                    if(this.cishu < 3){\r\n                        if(this.cishu === 0){\r\n                            if(this.map[0][this.nodeArr[2].getComponent(\"Stone\").col] != 1)\r\n                                this.nodeArr[2].active = true;\r\n                            else\r\n                                this.gameOver = true;    \r\n                        }else if(this.cishu === 1){\r\n                            if(this.map[1][this.nodeArr[1].getComponent(\"Stone\").col] != 1){\r\n                                this.nodeArr[2].y = this.backGroundArr[1][this.nodeArr[1].getComponent(\"Stone\").col].y;\r\n                                this.nodeArr[2].getComponent(\"Stone\").row = 1;\r\n                                this.nodeArr[1].active = true;\r\n                                this.nodeArr[1].y = this.backGroundArr[0][this.nodeArr[0].getComponent(\"Stone\").col].y;\r\n                                this.nodeArr[1].getComponent(\"Stone\").row = 0;\r\n                            }else{\r\n                                this.gameOver = true;\r\n                            }\r\n                        }else if(this.cishu === 2){\r\n                            if(this.map[2][this.nodeArr[1].getComponent(\"Stone\").col] != 1){\r\n                                this.nodeArr[2].y = this.backGroundArr[2][this.nodeArr[1].getComponent(\"Stone\").col].y;\r\n                                this.nodeArr[2].getComponent(\"Stone\").row = 2;\r\n        \r\n                                this.nodeArr[1].y = this.backGroundArr[1][this.nodeArr[0].getComponent(\"Stone\").col].y;\r\n                                this.nodeArr[1].getComponent(\"Stone\").row = 1;\r\n        \r\n                                this.nodeArr[0].active = true;\r\n                                this.nodeArr[0].getComponent(\"Stone\").row = 0;\r\n                            }else{\r\n                                this.gameOver = true;\r\n                            }\r\n                            \r\n                        }\r\n                        this.cishu++;\r\n                    }else{\r\n                        // this.cishu = 0;\r\n                        this.updatePrefatY(this.nodeArr,false);\r\n    \r\n                    }\r\n                    this.time = 0;\r\n                }\r\n            }else{\r\n                this.overMenu.active = true;\r\n                this.playAudio(this.loseAudio);\r\n                //显示分数\r\n                this.overMenu.getChildByName(\"scoreValue\").getComponent(cc.Label).string = this.score;\r\n                this.overCost += dt;\r\n                // //暂停游戏\r\n                // cc.director.pause();\r\n                if(cc.sys.localStorage.getItem('maxScoreStone') === undefined){\r\n                    //设置值\r\n                    cc.sys.localStorage.setItem('maxScoreStone',this.score);\r\n                }else{\r\n                    if(this.score > cc.sys.localStorage.getItem('maxScoreStone')){\r\n                        //设置值\r\n                        cc.sys.localStorage.setItem('maxScoreStone',this.score);\r\n                        //将最高分数保存起来\r\n                        cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").stoneTopScore = this.score.toString();\r\n                        // let username = cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").nameUser;\r\n                        //将最高分上传到微信托管平台\r\n                        cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").postMessage(\"SaveScore\",\"stoneRankScore\",this.score.toString());\r\n                    }\r\n                    console.log(\"宝石方块的最高分是: \",cc.sys.localStorage.getItem('maxScoreStone'));\r\n                }\r\n                if(this.overCost >= 4){\r\n                    //恢复游戏主逻辑\r\n                    cc.director.resume();\r\n                    cc.director.loadScene(\"OneChoose\");\r\n                    this.overCost = 0;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    Over : function(){\r\n        //将游戏结束的标记重置为true\r\n        this.gameOver = true;\r\n        //显示游戏结束图片  \r\n        // this.gameBye.active = true;\r\n    },\r\n    //设置游戏状态 --开始 --暂停 --游戏 --消除 --游戏结束 --\r\n    setState : function(state){\r\n        this.iState = state;\r\n    },\r\n    //更新预制体节点的y坐标\r\n    updatePrefatY : function(nodeArr,isNetWork){\r\n        var self = this;\r\n        cc.log(\"nodeArr is \" + nodeArr);\r\n        if(nodeArr.length != 0){\r\n            //如果允许下落的话条的y坐标向下移动\r\n            if(this.CheckIsDown(nodeArr)){\r\n                    //下落节点数组\r\n                    this.down(nodeArr,isNetWork);\r\n                //判断方格是否可以消除\r\n            }else{\r\n                //如果不能下落的话改变背景方格状态(背景方格更新完成之后进行再次生成节点数组)\r\n                this.updateMap(nodeArr);\r\n                // //生成下一个形状\r\n                // this.createNext();\r\n                this.invokeRemoveTime = 0;\r\n                var removeTime = 0;\r\n                //消除次数\r\n                function next(){\r\n                    if(isNetWork){\r\n                        //如果是网络版的话就加入网络接口\r\n                        if(removeTime > 0){\r\n                            let jsonR = {\r\n                                row : removeTime,\r\n                                col : 0,\r\n                            };\r\n                            removeJsonToServer.removeMapList1.push(jsonR);\r\n                            //向服务器发送消除的次数以便进行惩罚\r\n                            // cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(removeJsonToServer);\r\n                        }\r\n                    }\r\n                    //固定完之后重新生成随机预制体节点\r\n                    self.nodeArr = self.nextBlock;\r\n                    //生成下一个形状\r\n                    self.createNext();\r\n                    // this.nextBlock = this.next2Block;\r\n                }\r\n                (function(n){\r\n                    if(isNetWork){\r\n                        self.checkNodeArr(nodeArr,removeTime,isNetWork);\r\n                    }else{\r\n                        self.checkNodeArr(nodeArr,removeTime,isNetWork);\r\n                    }\r\n                    console.log(\"removeTiem is \" + removeTime);\r\n                    n();\r\n                })(next.bind(self));\r\n                \r\n               \r\n            }\r\n        }\r\n    },\r\n    updateMap : function(nodeArr){\r\n        if(nodeArr.length > 0){\r\n            for(let i = 0;i<nodeArr.length;i++){\r\n                var row = nodeArr[i].getComponent(\"Stone\").row;\r\n                var col = nodeArr[i].getComponent(\"Stone\").col;\r\n                this.map[row][col] = 1;\r\n                //将背景方格的属性状态改为该节点数组对应的类型\r\n                this.backGroundArr[row][col].getComponent(\"Back\").type = nodeArr[i].getComponent(\"Stone\").type;\r\n                this.backGroundArr[row][col].getComponent(\"Back\").innerNode = nodeArr[i];\r\n                nodeArr[i].getComponent(\"Stone\").downShine();\r\n            }\r\n        }\r\n    },\r\n    //方块下落方法\r\n    down : function(nodeArr,isNetWork){\r\n        //如果游戏结束的话不允许向下移动\r\n        if(!this.gameOver){\r\n            //位移3个方格\r\n            for(var i = nodeArr.length-1;i >= 0;i--){\r\n                var row = nodeArr[i].getComponent(\"Stone\").row;\r\n                var col = nodeArr[i].getComponent(\"Stone\").col;\r\n                nodeArr[i].y = this.backGroundArr[row+1][col].y; \r\n                nodeArr[i].getComponent(\"Stone\").row = row+1;\r\n            }\r\n        }\r\n    },\r\n    /*创建一个二维数组的方法\r\n     *@param rows : 二维数组的行数\r\n      @param cols : 二维数组的列数\r\n     *@param initial : 二维数组的初始值\r\n    */\r\n    createMatrix : function(rows,cols,initial){\r\n        var arr = [];\r\n        for(var i = 0;i < rows;i++){\r\n            var columns = [];\r\n            for(var j = 0;j<cols;j++){\r\n                columns[j] = initial;\r\n            }\r\n            arr[i] = columns;\r\n        }\r\n        return arr;\r\n    },\r\n    /**\r\n        1：旋转的时候判断旋转的坐标对应的背景方格的状态是否为1\r\n        2：当竖条出现在最左边的时候改变旋转中心为最上面的预制体节点\r\n        3：当竖条出现在最右边的时候改变旋转中心为最下面的预制节点\r\n    **/\r\n    rotate       : function(){\r\n        //游戏结束之后不可以再操作这些块了\r\n        if(!this.gameOver){\r\n            this.playAudio(this.clickAudio);\r\n            this.rotateButton.children[0].opacity = 120;\r\n            //判断周围的网格状态是否为true\r\n            /**\r\n             * \r\n             * 旋转之后方块的颜色变换，第一个变成第二个，第二个变成第三个，第三个变成第一个\r\n             * \r\n             * ** */\r\n            // cc.log(this.boxColorArr);\r\n            var before0Name = this.nodeArr[0].name;\r\n            var before0Type = this.nodeArr[0].getComponent(\"Stone\").type;\r\n            var before0Frame = this.nodeArr[0].getComponent(\"cc.Sprite\").spriteFrame;\r\n            var before0Row = this.nodeArr[0].getComponent(\"Stone\").row;\r\n            // cc.log(\"before0 is \" + before0);\r\n            var before1Name = this.nodeArr[1].name;\r\n            var before1Type = this.nodeArr[1].getComponent(\"Stone\").type;\r\n            var before1Frame = this.nodeArr[1].getComponent(\"cc.Sprite\").spriteFrame;\r\n            var before1Row = this.nodeArr[1].getComponent(\"Stone\").row;\r\n            // cc.log(\"before1 is \" + before1);\r\n            var before2Name = this.nodeArr[2].name;\r\n            var before2Type = this.nodeArr[2].getComponent(\"Stone\").type;\r\n            var before2Frame = this.nodeArr[2].getComponent(\"cc.Sprite\").spriteFrame;\r\n            var before2Row = this.nodeArr[2].getComponent(\"Stone\").row;\r\n            // cc.log(\"before2 is \" + before2);\r\n            //分别改变颜色\r\n            this.nodeArr[0].name = before2Name;\r\n            this.nodeArr[0].getComponent(\"Stone\").type = before2Type;\r\n            this.nodeArr[0].getComponent(\"cc.Sprite\").spriteFrame = before2Frame;\r\n            this.nodeArr[1].name = before0Name;\r\n            this.nodeArr[1].getComponent(\"Stone\").type = before0Type;\r\n            this.nodeArr[1].getComponent(\"cc.Sprite\").spriteFrame = before0Frame;\r\n            this.nodeArr[2].name = before1Name;\r\n            this.nodeArr[2].getComponent(\"Stone\").type = before1Type;\r\n            this.nodeArr[2].getComponent(\"cc.Sprite\").spriteFrame = before1Frame;\r\n            console.log(\"arguments's length is \",arguments.length);\r\n            console.log(\"arguments's length is \",arguments[0]);\r\n            //如果是网络版的发送旋转数据到服务器\r\n            if(arguments.length === 2){\r\n                //发送数据到服务器\r\n                var jsonData0 = {\r\n                    row : before0Row,\r\n                    col : this.nodeArr[0].getComponent(\"Stone\").col,\r\n                    color : before0Type.toString(),\r\n                };\r\n                var jsonData1 = {\r\n                    row  : before1Row,\r\n                    col : this.nodeArr[0].getComponent(\"Stone\").col,\r\n                    color : before1Type.toString(),\r\n                };\r\n                var jsonData2 = {\r\n                    row   : before2Row,\r\n                    col   : this.nodeArr[0].getComponent(\"Stone\").col,\r\n                    color : before2Type.toString(),\r\n                };\r\n                var jsonData3 = {\r\n                    row   : before0Row,\r\n                    col   : this.nodeArr[0].getComponent(\"Stone\").col,\r\n                    color : this.nodeArr[0].getComponent(\"Stone\").type.toString(),\r\n                };\r\n                var jsonData4 = {\r\n                    row   : before1Row,\r\n                    col   : this.nodeArr[0].getComponent(\"Stone\").col,\r\n                    color : this.nodeArr[1].getComponent(\"Stone\").type.toString(),\r\n                };\r\n                var jsonData5 = {\r\n                    row   : before2Row,\r\n                    col   : this.nodeArr[0].getComponent(\"Stone\").col,\r\n                    color : this.nodeArr[2].getComponent(\"Stone\").type.toString(),\r\n                };\r\n                var jsonArr = [];\r\n                jsonArr = Array.of(jsonData0,jsonData1,jsonData2,jsonData3,jsonData4,jsonData5);\r\n                console.log(\"jsonArr is \",jsonArr);\r\n                for(let m = 0;m < jsonArr.length;m++){\r\n                    this.jsonMsgToServer.changeMapList1.push(jsonArr[m]);\r\n                }\r\n            }\r\n            this.scheduleOnce(function(){\r\n                this.rotateButton.children[0].opacity = 0;\r\n            },0.2);\r\n        }\r\n    },\r\n    //左移方法\r\n    moveLeft    : function(){\r\n        //如果游戏结束就不能再左右移动\r\n        if(!this.gameOver){\r\n            if(this.CheckIsLeft()){\r\n                console.log(\"arguments.length is \",arguments.length);\r\n                var rowArr = [];\r\n                for(var i = 0;i < this.nodeArr.length;i++){\r\n                    //参数的长度为1的话被认定为网络版的方法\r\n                    if(arguments.length === 1){\r\n                        console.log(\"进入左移网络版\");\r\n                        this.leftMove(this.nodeArr[i],true);\r\n                        //将行数保留下来\r\n                        rowArr.push(this.nodeArr[i].getComponent(\"Stone\").row);\r\n                    }else{\r\n                        this.leftMove(this.nodeArr[i]);\r\n                    }\r\n                }\r\n                //网络版的方法\r\n                if(arguments.length === 1){\r\n                    console.log(\"进入网络版左移\");\r\n                    //将这些数据发送给服务器让对手显示游戏\r\n                    for(let m = 0;m < rowArr.length;m++){\r\n                        var jsonDataForServer = {\r\n                            row   : rowArr[m],\r\n                            col   : this.nodeArr[m].getComponent(\"Stone\").col+1,\r\n                            color : \"-1\",\r\n                        };\r\n                        this.jsonMsgToServer.changeMapList1.push(jsonDataForServer);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    leftMove : function(node){\r\n        var row = node.getComponent(\"Stone\").row;\r\n        var col = node.getComponent(\"Stone\").col;\r\n        //将当前背景节点的node改为null\r\n        node.x = this.backGroundArr[row][col-1].x;\r\n        //改变该节点的列\r\n        node.getComponent(\"Stone\").col = col-1;\r\n        //网络版的数据\r\n        if(arguments.length != 1){\r\n            //加入发送到服务器的信息\r\n            let afterLeftJson = {\r\n                row   : row,\r\n                col   : col - 1,\r\n                color : node.getComponent(\"Stone\").type.toString(),\r\n            }\r\n            this.jsonMsgToServer.changeMapList1.push(afterLeftJson);\r\n        }\r\n    },\r\n    //右移方法\r\n    moveRight   : function(){\r\n        if(!this.gameOver){\r\n            if(this.CheckIsRight()){\r\n                var rowArr = [];\r\n                for(var i = 0;i < this.nodeArr.length;i++){\r\n                    if(arguments.length === 1){\r\n                        console.log(\"进入左移网络版\");\r\n                        this.rightMove(this.nodeArr[i],true);\r\n                        //将行数保留下来\r\n                        rowArr.push(this.nodeArr[i].getComponent(\"Stone\").row);\r\n                    }else{\r\n                        this.rightMove(this.nodeArr[i]);\r\n                    }\r\n                }\r\n                if(arguments.length === 1){\r\n                    console.log(\"进入网络版左移\");\r\n                    //将这些数据发送给服务器让对手显示游戏\r\n                    for(let m = 0;m < rowArr.length;m++){\r\n                        var jsonDataForServer = {\r\n                            row   : rowArr[m],\r\n                            col   : this.nodeArr[m].getComponent(\"Stone\").col - 1,\r\n                            color : \"-1\",\r\n                        };\r\n                        this.jsonMsgToServer.changeMapList1.push(jsonDataForServer);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    rightMove : function(node){\r\n        var row = node.getComponent(\"Stone\").row;\r\n        var col = node.getComponent(\"Stone\").col;\r\n        node.x = this.backGroundArr[row][col+1].x;\r\n        //设置该节点的列\r\n        node.getComponent(\"Stone\").col = col + 1;\r\n        if(arguments.length != 1){\r\n            //加入发送到服务器的信息\r\n            let afterLeftJson = {\r\n                row   : row,\r\n                col   : col + 1,\r\n                color : node.getComponent(\"Stone\").type.toString(),\r\n            }\r\n            this.jsonMsgToServer.changeMapList1.push(afterLeftJson);\r\n        }\r\n    },\r\n    /**\r\n        检测是否可以向下移动\r\n        返回true或者false\r\n        @return true  : 可以下落\r\n        @return false : 不可以下落\r\n    **/\r\n    CheckIsDown : function(nodeArr){\r\n        if(nodeArr.length != 0){\r\n            var row = nodeArr[nodeArr.length - 1].getComponent(\"Stone\").row;\r\n            var col = nodeArr[nodeArr.length - 1].getComponent(\"Stone\").col;\r\n            //获取最后一个\r\n                //如果最大的行号是11的话不用再这里判断这样的情况是触底的情况\r\n                if(row != 11){\r\n                    if(this.map[row + 1][col] === 1){\r\n                        //将对应的背景方格的状态改为1\r\n                        return false;\r\n                    }else{\r\n                        return true;\r\n                    }\r\n                }else{\r\n                        return false;\r\n                }\r\n        }\r\n    },\r\n    /**\r\n       检测是否可以向左移动\r\n    **/\r\n   CheckIsLeft : function(){\r\n        var row = [];\r\n        for(var i = 0;i<3;i++){\r\n            row[i] = this.nodeArr[i].getComponent(\"Stone\").row;\r\n        }\r\n        var col = this.nodeArr[2].getComponent(\"Stone\").col;\r\n        //如果达到左边界不可左移\r\n        if(col <= 0){\r\n            return false;\r\n        }\r\n        //每下降一个格检测一次\r\n        //如果列的个数为1的话\r\n        for(var m = 0;m<row.length;m++){\r\n            //获得行数\r\n            var mr = row[m];\r\n            //只要一个方格的左边的背景方格的状态为1的话就停止移动\r\n            if(this.map[mr][col - 1] === 1){\r\n                //一个方格的左边背景方格的状态是1的话就说明不可以向左边移动\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n    //检测是否可以向右移动\r\n    CheckIsRight : function(){\r\n        var row = [];\r\n        for(var i = 0;i<3;i++){\r\n            row[i] = this.nodeArr[i].getComponent(\"Stone\").row;\r\n        }\r\n        var col = this.nodeArr[2].getComponent(\"Stone\").col;\r\n        //如果达到右边界不可右移\r\n        if(col >= 5){\r\n            return false;\r\n        }\r\n        //每下降一个格检测一次\r\n        //如果列的个数为1的话说明是竖条的形状\r\n        for(var m = 0;m<row.length;m++){\r\n            //获得行数\r\n            var mr = row[m];\r\n            //只要一个方格的左边的背景方格的状态为1的话就停止移动\r\n            if(this.map[mr][col + 1] === 1){\r\n                //一个方格的左边背景方格的状态是1的话就说明不可以向左边移动\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n    //改变该节点数组是否存在可消除的节点\r\n    checkNodeArr : function(nodeArr,removeTime,isNetWork){\r\n        if(nodeArr.length != 0){\r\n            if(nodeArr.length > 0){\r\n                //临时数组存放待消节点\r\n                var waitQueue = [];\r\n                if(this.canRemove(nodeArr,waitQueue)){\r\n                    //如果是可以消除的话进行消除这时候待消队列已经填满了节点\r\n                    // this.remove(this.nodeArr);\r\n                    //检测完这两个下落的方块的待消队列\r\n                    for(let j = 0;j<waitQueue.length;j++){\r\n                        //如果该节点已经删除的话不对它操作\r\n                        if(waitQueue[j] === null){\r\n                            //将它从该数组删除\r\n                            waitQueue.splice(j,1);\r\n                        }\r\n                        //将这些待消除的标记为可消除的\r\n                        waitQueue[j].getComponent(\"Stone\").isRemove = true;\r\n                    }\r\n                    // this.tempNodes = waitQueue;\r\n                    this.addScore(waitQueue.length);\r\n                    //该消除的消除该下落的下落\r\n                    if(isNetWork){\r\n                        return this.remove(waitQueue,removeTime,isNetWork);\r\n                    }else{\r\n                        this.remove(waitQueue,removeTime,isNetWork);\r\n                    }\r\n                }else{\r\n                    //如果是网络版的走这句话\r\n                    if(isNetWork){\r\n                        if(this.rivalTouchBarry){\r\n                            console.log(\"对手不能消除在发送消息给服务器！！！！！！\");\r\n                            // callback(0);\r\n                            return new Promise(function(resolve,reject){\r\n                                console.log(\"进入消除零次的Promise\");\r\n                                resolve(0);\r\n                            });\r\n                        }else{\r\n                            //如果是自己的话消除零次发送给服务器但是在不能下落的时候不发送该数据\r\n                            return new Promise(function(resolve,reject){\r\n                                console.log(\"对手没有给我发消息\");\r\n                                resolve(0); \r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                \r\n            }\r\n        }    \r\n    },\r\n    //消除代码\r\n    /**\r\n     * @param  {待消队列} waitQueue\r\n     * @param  {消除次数} removeTime\r\n     * @param  {是否是网络版的宝石方块} isNetWork\r\n     */\r\n    remove : function(waitQueue,removeTime,isNetWork){\r\n        //连消的情况是remove方法被执行了几次就形成了几次连消\r\n        // this.removeTime++;\r\n        // if(this.removeTime >= 2){\r\n        //     cc.log(\"连消了两次\");\r\n        // }\r\n        this.playAudio(this.removeAudio);\r\n        removeTime++\r\n        this.invokeRemoveTime++;\r\n        this.totalRemoveTime++;\r\n        this.totalTime++;\r\n        if(removeTime >= 2){\r\n            var scoreLabel = this.scoreLabel.getComponent(cc.Label);\r\n            cc.log(\"产生了连消！！！！\");\r\n            if(removeTime === 2){\r\n                //产生一次连击\r\n                this.score += 10;\r\n            }else if(removeTime === 3){\r\n                //产生两次连击\r\n                this.score += 20;\r\n            }else if(removeTime === 4){\r\n                //产生3次连击\r\n                this.score += 30;\r\n            }else if(removeTime === 5){\r\n                //产生4次连击\r\n                this.score += 40;\r\n            }\r\n            scoreLabel.string = this.score;\r\n        }\r\n        var waitDownArr = [];\r\n        // for(let m = 0;m<waitQueue.length;m++){\r\n        //     var cRow = waitQueue[m].getComponent(\"Stone\").row;\r\n        //     var cCol = waitQueue[m].getComponent(\"Stone\").col;\r\n        //     this.upFindNodes(cRow,cCol,waitDownArr);\r\n        // }\r\n        // cc.log(\"待下落节点数组为：\" + waitDownArr);\r\n        this.deleteNodeFromParent(waitQueue,waitDownArr);\r\n        \r\n        // if(!waitDownArr.contain(activeNode))\r\n        //     waitDownArr.push(activeNode);\r\n        //下落其他节点让节点自己找空穴目标位置进行下落\r\n        // for(let j = 0;j<waitDownArr.length;j++){\r\n        //      waitDownArr[j].getComponent(\"Stone\").afterRemoveDown(this.map,this.backGroundArr);\r\n        //     //  waitDownArr[j].stopAction();\r\n        // }\r\n        \r\n        //检查这些下落的节点数组是否可以再次消除\r\n        if(!isNetWork){\r\n            this.scheduleOnce(function(){\r\n                this.checkNodeArr(waitDownArr,removeTime,isNetWork);\r\n            }.bind(this),0.5);\r\n        }else{\r\n            var self = this;\r\n            function next(){\r\n                //向服务器发送分数信息\r\n                var jsonMsgToServer = {\r\n                    tag1            : 11,\r\n                    score           : 0,\r\n                    type            : \"4\",\r\n                    state1          : \"\",\r\n                    changeMapList1  : [],\r\n                    removeMapList1  : 0,\r\n                    nMapRow         : \"\",\r\n                    nMapCol         : \"\",\r\n                    loading1        : \"\",\r\n                    nDisappear1     : 0,\r\n                }\r\n                jsonMsgToServer.tag1 = 11;\r\n                jsonMsgToServer.score = self.score;\r\n                jsonMsgToServer.nDisappear1 = self.score;\r\n                // cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(jsonMsgToServer);\r\n                // return true;\r\n            }\r\n            function waitPromise(){\r\n                return new Promise(function(resolve,reject){\r\n                    setTimeout(function(){\r\n                        console.log(\"1034 line \" + removeTime);\r\n                        //检查是否能再次消除\r\n                        var isP = self.checkNodeArr(waitDownArr,removeTime,isNetWork);\r\n                        if(isP instanceof Promise){\r\n                            console.log(\"1038 --->\" + isP);\r\n                            isP.then(function(data){\r\n                                resolve(data);\r\n                            });\r\n                        }\r\n                    },500);\r\n                });\r\n            }\r\n            return waitPromise().then(function(data){\r\n                console.log(\"在消除方法中消除次数是\",removeTime);\r\n                console.log(\"全局的消除变量是\",self.invokeRemoveTime);\r\n                next();\r\n                // overPromise();\r\n            });\r\n        }\r\n        \r\n        \r\n    },\r\n    /**\r\n     * 依据带消除队列里的长度进行计算分数\r\n     * @param  {待消除队列的长度} waitQueueLength\r\n     */\r\n    addScore : function(waitQueueLength){\r\n        var scoreLabel = this.scoreLabel.getComponent(cc.Label);\r\n        switch(waitQueueLength){\r\n            case 3:\r\n                this.score += 30;\r\n                break;\r\n            case 4:\r\n                this.score += 40;\r\n                break;\r\n            case 5:\r\n                this.score += 50;\r\n                break;\r\n            case 6:\r\n                this.score += 60;\r\n                break;\r\n            case 7:\r\n                this.score += 70;\r\n                break;\r\n            case 8:\r\n                this.score += 80;\r\n                break;\r\n            case 9:\r\n                this.score += 90;\r\n                break;                        \r\n        }\r\n        //显示分数\r\n        scoreLabel.string = this.score;\r\n    },\r\n    canRemove : function(nodeArr,waitQueue){\r\n        for(let i = 0;i < nodeArr.length;i++){\r\n            this.addWillDeleteArr(nodeArr[i],waitQueue);\r\n        }\r\n        if(waitQueue.length >= 3){\r\n           return true;\r\n        }else{\r\n            return false;\r\n        }\r\n    },\r\n    /**\r\n     * @param  {需要各个方向扫描的节点} node\r\n     * @param  {消除队列} willDeleteArr\r\n     */\r\n    addWillDeleteArr(node,willDeleteArr){\r\n        //用于存放该节点类型数组,存放个数>=3个的节点\r\n        var typeArr = [];\r\n        //获得宝石的类型\r\n        var type = node.getComponent(\"Stone\").type;\r\n        //获得当前方格节点所在的行\r\n        var row = node.getComponent(\"Stone\").row;\r\n        //获得当前节点所在的列\r\n        var col = node.getComponent(\"Stone\").col;\r\n        for(var i = 0;i<4;i++){\r\n            //四个方向查找待消节点\r\n            this.directorFind(typeArr,row,col,i,type,node);\r\n        }\r\n        cc.log(\"typeArr is \" + typeArr);\r\n        if(typeArr.length >= 3){\r\n            for(let t = 0;t<typeArr.length;t++){\r\n                //将待消除的节点添加到待消队列里面去\r\n                if(!willDeleteArr.contain(typeArr[t])){\r\n                    //将该节点push进待消队列\r\n                    willDeleteArr.push(typeArr[t]);\r\n                }\r\n            }\r\n        }\r\n        cc.log(\"willDeleteArr is \" + willDeleteArr);\r\n    },\r\n    /**\r\n     * 根据角度填充各个方向数组\r\n     * @param  {遍历每个节点的时候传递进来的一个空数组} typeArr\r\n     * @param  {需要扫描的节点的行} row\r\n     * @param  {需要扫描的节点的列} col\r\n     * @param  {需要扫描的方向} direction\r\n     * @param  {该节点的类型} type\r\n     * @param  {当前需要各个方向扫描的节点} node\r\n     */\r\n    directorFind : function(typeArr,row,col,direction,type,node){\r\n        //存放这个方向的临时数组\r\n        var directionArr = [];\r\n        //45度和-135度方向检测\r\n        var leftRow = row;\r\n        var leftCol = col;\r\n        // if(leftCol === undefined){\r\n        //     cc.director.pause();\r\n        //     //暂停游戏\r\n        //     cc.director.pause();\r\n        // }\r\n        //先把自己push进去(前提是类型相同)\r\n        directionArr.push(node);\r\n        while(leftRow >= 0 || leftRow <= 11 || leftCol >= 0 || leftCol <= 5){\r\n             //行和列都减1\r\n             //0度方向\r\n             if(direction === 0){\r\n                leftCol++;\r\n             }else if(direction === 1){\r\n                 //90度方向\r\n                 leftRow--;\r\n             }else if(direction === 2){\r\n                 //45度方向\r\n                 leftRow--;\r\n                 leftCol++;\r\n             }else if(direction === 3){\r\n                 //135度方向\r\n                 leftCol--;\r\n                 leftRow--;\r\n             }\r\n             //如果寻找的行或者列超出边界\r\n             if(leftRow < 0 || leftRow >11 || leftCol < 0 || leftCol > 5){\r\n                 break;\r\n             }\r\n            //  alert(\"leftRow-->\" + leftRow + \"leftCol-->\"+leftCol);\r\n             cc.log(\"leftRow is \" + leftRow + \" leftCol is \" + leftCol + \" type is \" + type);\r\n             if(this.isCommonType(leftRow,leftCol,type)){\r\n                 //如果当前数组里有当前的元素就不加进去了\r\n                 var nextNode = this.backGroundArr[leftRow][leftCol].getComponent(\"Back\").innerNode;\r\n                 if(!directionArr.contain(nextNode)){\r\n                    //如果找到跟自己颜色一样的话将它放到消除队列里面\r\n                    directionArr.push(nextNode);\r\n                 }\r\n             }else{\r\n                 break;\r\n             }\r\n        }\r\n        leftRow = row;\r\n        leftCol = col;\r\n        while(leftRow >= 0 || leftRow <= 11 || leftCol >=0 || leftCol <= 5){\r\n            if(direction === 1){\r\n                //-90度方向\r\n                leftRow++;\r\n            }else if(direction === 0){\r\n                //180度方向\r\n                leftCol--;\r\n            }else if(direction === 2){\r\n                //-135度方向\r\n                leftRow++;\r\n                leftCol--;\r\n            }else if(direction === 3){\r\n                //-45度方向\r\n                leftCol++;\r\n                leftRow++;\r\n            }\r\n            //如果超出了边界就退出当前循环\r\n            if(leftRow < 0 || leftRow >11 || leftCol < 0 || leftCol > 5){\r\n                break;\r\n            }\r\n            // alert(\"leftRow-->\" + leftRow + \"leftCol-->\"+leftCol);\r\n            if(this.isCommonType(leftRow,leftCol,type)){\r\n                var nextNode = this.backGroundArr[leftRow][leftCol].getComponent(\"Back\").innerNode;\r\n                //将该节点的待消状态设置为true\r\n                if(!directionArr.contain(nextNode)){\r\n                    //如果找到跟自己颜色一样的话将它放到消除队列里面\r\n                    directionArr.push(nextNode);\r\n                 }\r\n            }else{\r\n                break;\r\n            }\r\n        }\r\n        if(directionArr.length >= 3){\r\n             //加上自己就满足消除条件了\r\n            //  return typeArr;\r\n             for(let j = 0;j<directionArr.length;j++){\r\n                 //将这些节点的待消状态改为true\r\n                 directionArr[j].getComponent(\"Stone\").isRemove = true;\r\n                 //将该形状类加入到相同类型的数组里\r\n                 typeArr.push(directionArr[j]);\r\n             }\r\n        }\r\n    },\r\n    \r\n    //向上找节点\r\n    /**\r\n     * @param  {当前节点所在的行} row\r\n     * @param  {当前节点所在的列} col\r\n     * @param  {存放消除节点以上的节点数组} arr\r\n     */\r\n    upFindNodes : function(row,col,arr){\r\n        if(arguments.length === 2){\r\n            var tempArr = [];\r\n        }\r\n        while(row > 0){\r\n            row--;\r\n            var upNode = this.backGroundArr[row][col].getComponent(\"Back\").innerNode;\r\n            if(upNode != null){\r\n                if(upNode.getComponent(\"Stone\").isRemove === true){\r\n                    continue;\r\n                }else{\r\n                    if(arguments.length === 3){\r\n                        //将不是待消节点添加到数组中去\r\n                        if(!arr.contain(upNode)){    \r\n                            //如果该数组中还没有该节点的话就加进去\r\n                            arr.push(upNode);\r\n                        }\r\n                    }else{\r\n                        if(!tempArr.contain(upNode))\r\n                            tempArr.push(upNode);\r\n                    }\r\n                }\r\n            }else{\r\n                //如果upNode是空的话\r\n                break;\r\n            }\r\n        }\r\n        if(arguments.length === 2){\r\n            return tempArr;\r\n        }\r\n    },\r\n    /**\r\n     * @param  {待消除队列} waitQueue\r\n     */\r\n    deleteNodeFromParent : function(waitQueue,waitDownArr){\r\n        for(let i = 0;i<waitQueue.length;i++){\r\n            var row = waitQueue[i].getComponent(\"Stone\").row;\r\n            var col = waitQueue[i].getComponent(\"Stone\").col;\r\n            //恢复地图信息\r\n            this.map[row][col] = 0;\r\n            //恢复背景方格的原始属性\r\n            this.backGroundArr[row][col].getComponent(\"Back\").type = -1;\r\n            this.backGroundArr[row][col].getComponent(\"Back\").innerNode = null;\r\n            waitQueue[i].getComponent(\"Stone\").shine();\r\n            //获得该节点以上的所有节点\r\n            var downArr = this.upFindNodes(row,col);\r\n            for(let j = 0;j<downArr.length;j++){\r\n                 if(!waitDownArr.contain(downArr[j])){\r\n                     waitDownArr.push(downArr[j]);\r\n                 }\r\n                 downArr[j].getComponent(\"Stone\").afterRemoveDown(this.map,this.backGroundArr);\r\n            }\r\n        }\r\n    },\r\n    //判断类型是否和传进来的类型相同\r\n    /**\r\n     * @param  {该节点所处的行} row\r\n     * @param  {该节点所处的列} col\r\n     * @param  {该节点的类型} type\r\n     * @returns {Boolean} true | false\r\n     */\r\n    isCommonType : function(row,col,type){\r\n          //如果该行该列的背景网格的内置节点为空的话说明该网格没有宝石\r\n          if(this.backGroundArr[row][col].getComponent(\"Back\").innerNode === null){\r\n              return false;\r\n          }else{\r\n              return this.backGroundArr[row][col].getComponent(\"Back\").type === type ? true : false;\r\n          }\r\n    },\r\n    //生成下一个形状\r\n    generateNext : function(parentNode){\r\n        return this.createShape(parentNode);\r\n    },\r\n    pause : function(){\r\n        if(!this.gameOver){\r\n            //暂停游戏\r\n            cc.director.pause();\r\n            console.log(\"暂停游戏开始宝石单机\");\r\n            this.mask.active = true;\r\n            this.pauseMenu.active = true;\r\n        }\r\n        \r\n    },\r\n    \r\n});"]}