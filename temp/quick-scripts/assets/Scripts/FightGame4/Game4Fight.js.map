{"version":3,"sources":["Game4Fight.js"],"names":["comm","require","game3","statuMachine","cc","Class","extends","Component","properties","imagePrefabArr","default","type","Prefab","girdSize","back","nextShape","Node","next2","downButton","slideButton","rotateButton","mask","nickName","scoreLabel","overMenu","gameOverAnimation","gameSlide","clickAudio","url","AudioClip","winAudio","loseAudio","removeAudio","downAudio","handNode","darkNode","noticeButton","onLoad","CC_WECHATGAME","director","preloadScene","console","log","showNoticeHelp","on","active","bind","find","getComponent","SendLongMsg","nUserScore","normalSpeed","quickSpeed","giveIn","isPaused","resume","jsonMsgToServer","tag1","score","state1","changeMapList1","removeMapList1","nMapRow","nMapCol","loading1","length","Label","string","nameUser","nodeHeight","node","height","nodeWidth","width","up","lr","initMap","MAP_ROW","MAP_COL","nodeArr","initImage","createNext","times","iState","totalTime","registerKeyBoard","quick","time","xltime","cishu","children","opacity","playAudio","gameOver","status","Array","prototype","contain","undefined","i","x","y","isContain","data","j","row","col","color","tempNodes","san","nCol","self","rivalTouchBarry","isTouch","isPunish","invokeRemoveTime","hasOver","isWin","noticeFun","onSlide","onGameSlide","systemEvent","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","event","slidePositionX","slidePosition","getLocation","gameSlidePosition","getTouchLine","touchNode","worldPosition","localX","convertToNodeSpaceAR","v2","n1","Math","floor","n2","keyCode","KEY","down","left","moveLeft","right","moveRight","f","rotate","onDestroy","off","start","createRandomX","randomNumber","backGroundArr","createRandom","min","max","random","map","tempY","Number","toFixed","outArr","mapData","tempX","tempPrefab","setPrefabPosition","arguments","isFilled","innerNode","parentNode","addJsonData","randomCol","prefabArrTemp","isCreateOver","loopCount","generateCount","index","controlRandom","punishType","prefabNode","createPrefab","setPosition","addChild","push","id","rnd","next2Block","nextBlock","generateNext","showNextShape","childrenCount","k","destroy","prefab","instantiate","getColumn","indexGrid","chooseColumnByLocation","getRow","yIndexResult","chooseRawByLocation","getNodeArrMaxCol","maxCol","colArr","apply","getNodeArrMinCol","minCol","update","dt","column","STATE_BEGIN","STATE_PLAY","sendJsonData","toString","sendDown","sendJsonData1","sendJsonData0","updatePrefatY","sendChangeDataToServer","sendLeft","sendRight","sendRotate","gameBye","interactable","getChildByName","gameOverJson","result_score","gameOverJson1","result","showAdvice","pause","CheckIsDown","next","removeJsonToServerWithPunish","removeRow","changeMap","removeTime","checkNodeArr","then","jsonR","removeJsonToServer","share","shareFriends","sys","isNative","nativeShare","waitQueue","canRemove","isRemove","splice","addScore","remove","Promise","resolve","reject","waitDownArr","m","cRow","cCol","upFindNodes","activeNode","deleteNodeFromParent","afterRemoveDown","nDisappear1","waitPromise","setTimeout","isP","hasDown","queue","tempArr","cType","nodeType","waitQueueLength","activeNodeArr","checkHasSealBlock","shine","removeJsonInfo","directionArr","crow","ccol","anim","Animation","isActive","sendJson","playAnimAndChangeState","name","setPositionX","play","dynamicLoad","nodeName","callback","err","spriteFrame","Sprite","test","loader","loadRes","SpriteFrame","arr","upNode","round","checkType","waitDeleteNode","minRow","of","colNum","includes","afterDownRow","currentJson","upZero","remainTwoNumber","x0","y0","x0Row","x0Col","rotate45X","cos","PI","sin","rotate45Y","nodeAngle","angle","canAction","changeRotateCenter","checkIsRotate","bezier","dealRotate","pro","cb","bezierAction","bezierTo","runAction","scheduleOnce","angleCode","nodeZeroType","nodeOneType","json1","json2","json3","rotate90X","rotate90Y","createJsonDateForServer","jsonArr","pushChangeMapList","e","p","jsonData","sendDataToServer","jsonMsg","canRotate","x00","y00","x00Row","x00Col","xx","yy","rotate45Xc","rotate45Yc","checkIsRotateByRotateCenter","centerRow","centerCol","CheckIsLeft","call","rowArr","leftMove","jsonDataToServer","afterLeftJson","CheckIsRight","rightMove","afterRightJson","checkIsBottom","checkDown","targetNode","targetRow","findTheNodeDown","quickDown","count1","count0","nodeDownIsZero","wasPunishedByRival","punishArr","jsonNumber","Object","punishCol","generatePunishBlock","count","generatePunishJson","punishBlockArr","showScoreForGame1","removeRows","parseInt","overAgain","loadScene","overQuit","overShare","audioUrl","audioEngine"],"mappings":"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AlF,EAAwF;AACpF,+BAAO,IAAP;AACH;AACJ;AACD,uBAAO,KAAP;AACH;AACD,mBAAO,KAAP;AACH,SAVD;AAWA;AACA,aAAKC,SAAL,GAAiB,EAAjB;AACA,aAAKC,GAAL,GAAW,CAAX;AACA;AACA,aAAKnD,KAAL,GAAa,CAAb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,aAAKrC,IAAL,CAAUwB,MAAV,GAAmB,KAAnB;AACA;AACA,aAAKrB,QAAL,CAAcqB,MAAd,GAAuB,KAAvB;AACA;AACA,aAAKiE,IAAL,GAAY,CAAZ;AACA,aAAKrF,iBAAL,CAAuBoB,MAAvB,GAAgC,KAAhC;AACA,YAAIkE,OAAO,IAAX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,aAAKC,eAAL,GAAuB,KAAvB;AACA;AACA,aAAKC,OAAL,GAAe,KAAf;AACA;AACA,aAAKC,QAAL,GAAgB,KAAhB;AACA,aAAKC,gBAAL,GAAwB,CAAxB;AACA;AACA,aAAKC,OAAL,GAAe,KAAf;AACA;AACA,aAAKC,KAAL,GAAa,KAAb;AACH,KAjVI;;AAkVLC,eAAY,qBAAU;AAClB,a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","file":"Game4Fight.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Scripts\\FightGame4","sourcesContent":["/*\r\n * @Author: mikey.zhaopeng \r\n * @Date: 2018-06-25 14:28:29 \r\n * @Last Modified by: mikey.zhaopeng\r\n * @Last Modified time: 2018-08-19 14:52:20\r\n */\r\nvar comm = require(\"../game3/Common\");\r\nvar game3 = require(\"../game3/game\");\r\nvar statuMachine = require(\"../game4/StatuMachine\");\r\n//引用异步操作模块\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        imagePrefabArr : {\r\n            default : [],\r\n            type    : [cc.Prefab],\r\n        },\r\n        girdSize    : 120,\r\n        back        : cc.Prefab,\r\n        nextShape : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        next2 : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        downButton : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        slideButton : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        rotateButton : {\r\n            default  : null,\r\n            type     : cc.Node,\r\n        },\r\n        //遮罩层\r\n        mask : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //昵称label\r\n        nickName : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //分数label\r\n        scoreLabel : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //游戏结束菜单\r\n        overMenu  : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        gameOverAnimation : cc.Node,\r\n        gameSlide : cc.Node,\r\n        //点击按钮的声音\r\n        clickAudio : {\r\n            url  : cc.AudioClip,\r\n            default : null,\r\n        },\r\n        //胜利音效\r\n        winAudio : {\r\n            url  : cc.AudioClip,\r\n            default : null,\r\n        },\r\n        //失败音效\r\n        loseAudio : {\r\n            url  : cc.AudioClip,\r\n            default : null,\r\n        },\r\n        //消除音效\r\n        removeAudio : {\r\n            url  : cc.AudioClip,\r\n            default : null,\r\n        },\r\n        //快速下落音效\r\n        downAudio : {\r\n            url  : cc.AudioClip,\r\n            default : null,\r\n        },\r\n        handNode : cc.Node,\r\n        darkNode : cc.Node,\r\n        noticeButton : cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        if(CC_WECHATGAME){\r\n        }\r\n        //预加载需要的场景\r\n        cc.director.preloadScene(\"PersonsChoose\",function(){\r\n            console.log(\"多人选择界面预加载成功\");\r\n        });\r\n        cc.director.preloadScene(\"MatchUser\",function(){\r\n            console.log(\"匹配界面预加载成功\");\r\n        });\r\n        this.showNoticeHelp = true;\r\n        this.handNode.on(\"touchstart\",function(){\r\n            this.handNode.active = false;\r\n            this.darkNode.active =false;\r\n            this.noticeButton.active = false;\r\n            this.showNoticeHelp = false;\r\n        }.bind(this));\r\n        this.darkNode.on(\"touchstart\",function(){\r\n            this.handNode.active = false;\r\n            this.darkNode.active =false;\r\n            this.noticeButton.active = false;\r\n            this.showNoticeHelp = false;\r\n        }.bind(this));\r\n        //发送到服务器中的数据\r\n        cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg({\"tag1\":10,\"type\":\"\",\"score\":cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").nUserScore,\"nMapRow\":\"\",\"nMapCol\":\"\",\"loading1\":1});\r\n        this.normalSpeed = 0.8;\r\n        this.quickSpeed  = 0.07;\r\n        this.giveIn = false;\r\n        //如果游戏是处于暂停状态的时候让游戏继续运行\r\n        if(cc.director.isPaused()){\r\n            cc.director.resume();\r\n        }\r\n         //发给服务器的数据\r\n         this.jsonMsgToServer = {\r\n            tag1            : 9,\r\n            score           : \"\",\r\n            type            : \"\",\r\n            state1          : \"\",\r\n            changeMapList1  : [],\r\n            removeMapList1  : 0,\r\n            nMapRow         : \"\",\r\n            nMapCol         : \"\",\r\n            loading1        : \"\",\r\n        };\r\n        console.log(\"!!!!!!!!!!!!!!!!!!!\" + this.jsonMsgToServer.changeMapList1.length);\r\n        this.nickName.getComponent(cc.Label).string = cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").nameUser;\r\n         this.nodeHeight = this.node.height;\r\n         this.nodeWidth = this.node.width;\r\n         this.up = 12;\r\n         this.lr = 10;\r\n         this.back.width = 120;\r\n         this.back.height = 120;\r\n         this.initMap(this.up,this.lr,this.back,comm.MAP_ROW,comm.MAP_COL);\r\n         //创建一个空节点用来盛放生成的预制体\r\n         this.nodeArr = this.initImage(this.node,null);\r\n         this.createNext();\r\n         //从游戏屏幕上下落的次数\r\n         this.times = 0;\r\n        //  //开始下落\r\n        //  this.downFunction(this.nodeArr,1);\r\n         this.iState = 0;\r\n         this.totalTime = 0;\r\n         this.registerKeyBoard();\r\n         this.quick = false;\r\n         this.time = 0;\r\n         this.xltime = this.normalSpeed;\r\n         this.cishu = 0;\r\n         //监听下落按钮按下的时候\r\n         this.downButton.on(\"touchstart\",function(){\r\n            this.xltime = this.quickSpeed;\r\n            this.downButton.children[0].opacity = 120;\r\n            this.playAudio(this.clickAudio);\r\n         }.bind(this));\r\n         //下落按钮离开时候\r\n         this.downButton.on(\"touchend\",function(){\r\n            this.xltime = this.normalSpeed;\r\n            this.downButton.children[0].opacity = 0;\r\n         }.bind(this));\r\n         this.gameOver = false;\r\n         this.status = 0;\r\n         Array.prototype.contain = function(node){\r\n            if(node != undefined){\r\n                for(var i = 0;i<this.length;i++){\r\n                    if(this[i].x === node.x && this[i].y === node.y && this[i].getComponent(\"Figure\").type === node.getComponent(\"Figure\").type){\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n            return false;\r\n        };\r\n        //对发送给服务器中的数据进行去重\r\n        Array.prototype.isContain = function(data){\r\n            if(data !== undefined){\r\n                for(let j = 0;j < this.length;j++){\r\n                    if(this[j].row === data.row && this[j].col === data.col && this[j].color === data.color){\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n            return false;\r\n        }\r\n        // console.log(\"nickName is \" + this.nickName);\r\n        this.tempNodes = [];\r\n        this.san = 0;\r\n        //计分数字\r\n        this.score = 0;\r\n        //旋转按钮旋转\r\n        // var rotateAction = cc.rotateBy(3,360).easing(cc.easeCubicActionOut());\r\n        // var rf = cc.repeatForever(rotateAction);\r\n        // this.rotateButton.runAction(rf);\r\n\r\n        // Menu.prototype.onLoad();\r\n\r\n        //不显示遮罩层\r\n        this.mask.active = false;\r\n        //不显示游戏结束菜单\r\n        this.overMenu.active = false;\r\n        //当前的行号\r\n        this.nCol = 0;\r\n        this.gameOverAnimation.active = false;\r\n        var self = this;\r\n        // this.pause.on(\"touchstart\",function(){\r\n        //     if(!self.gameOver){\r\n        //         //暂停游戏\r\n        //         console.log(\"点击了网络版的暂停\");\r\n        //         self.mask.active = true;\r\n        //         self.pauseMenu.active = true;\r\n        //     }\r\n        // }.bind(this))\r\n        // this.pauseGaveIn.on(\"touchstart\",function(){\r\n        //     self.mask.active = false;\r\n        //     // this.pauseMenu.active = false;\r\n        //     self.pauseMenu.active = false;\r\n        //     self.giveIn = true;\r\n        //     // //向服务器发送投降消息\r\n        //     // self.gameBye();\r\n        //     var jsonData = {\r\n        //         tag1            : 5,\r\n        //         score           : \"\",\r\n        //         type            : \"4\",\r\n        //         state1          : \"\",\r\n        //         changeMapList1  : [],\r\n        //         removeMapList1  : 0,\r\n        //         nMapRow         : \"\",\r\n        //         nMapCol         : \"\",\r\n        //         loading1        : \"\",\r\n        //     }\r\n        //     cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(jsonData);\r\n        //     //显示失败\r\n        //     this.playAudio(this.loseAudio);\r\n        //     //其他下降，旋转按钮，左右移动按钮处于不可激活状态\r\n        //     this.downButton.interactable = false;\r\n        //     this.rotateButton.interactable = false;\r\n        //     this.slideButton.interactable = false;\r\n        //     //显示结束动画\r\n        //     this.gameOverAnimation.active = true;\r\n        //     // var animation = this.gameOverAnimation.getComponent(cc.Animation);\r\n        //     // animation.play(\"Over_light\"); \r\n        //     this.overMenu.active = true;\r\n        //     this.mask.active = true;\r\n        //     //自己失败显示失败\r\n        //     this.overMenu.getChildByName(\"lose\").active = true;\r\n        //     //自己没有赢不显示胜利的标记\r\n        //     this.overMenu.getChildByName(\"win\").active = false;\r\n        //     //显示分数\r\n        //     this.overMenu.getChildByName(\"Score\").getComponent(cc.Label).string = this.score.toString();\r\n        //     cc.director.loadScene(\"PersonsChoose\");\r\n        // }.bind(this));\r\n        // this.pauseRestart.on(\"touchstart\",function(){\r\n        //     cc.director.resume();\r\n            \r\n        //     self.mask.active = false;\r\n        //     self.pauseMenu.active = false;\r\n        //     var jsonData = {\r\n        //         tag1            : 5,\r\n        //         score           : \"\",\r\n        //         type            : \"4\",\r\n        //         state1          : \"\",\r\n        //         changeMapList1  : [],\r\n        //         removeMapList1  : 0,\r\n        //         nMapRow         : \"\",\r\n        //         nMapCol         : \"\",\r\n        //         loading1        : \"\",\r\n        //     }\r\n        //     cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(jsonData);\r\n        //     //显示失败\r\n        //     this.playAudio(this.loseAudio);\r\n        //     //其他下降，旋转按钮，左右移动按钮处于不可激活状态\r\n        //     this.downButton.interactable = false;\r\n        //     this.rotateButton.interactable = false;\r\n        //     this.slideButton.interactable = false;\r\n        //     //显示结束动画\r\n        //     this.gameOverAnimation.active = true;\r\n        //     // var animation = this.gameOverAnimation.getComponent(cc.Animation);\r\n        //     // animation.play(\"Over_light\"); \r\n        //     this.overMenu.active = true;\r\n        //     this.mask.active = true;\r\n        //     //自己失败显示失败\r\n        //     this.overMenu.getChildByName(\"lose\").active = true;\r\n        //     //自己没有赢不显示胜利的标记\r\n        //     this.overMenu.getChildByName(\"win\").active = false;\r\n        //     //显示分数\r\n        //     this.overMenu.getChildByName(\"Score\").getComponent(cc.Label).string = this.score.toString();\r\n        //     cc.director.loadScene(\"PersonsChoose\");\r\n        // }.bind(this));\r\n        // this.pauseReturn.on(\"touchstart\",function(){\r\n        //     cc.director.resume();\r\n        //     self.mask.active = false;\r\n        //     self.pauseMenu.active = false;\r\n        //     //发送消息给服务器\r\n        //     var jsonData = {\r\n        //         tag1            : 5,\r\n        //         score           : \"\",\r\n        //         type            : \"4\",\r\n        //         state1          : \"\",\r\n        //         changeMapList1  : [],\r\n        //         removeMapList1  : 0,\r\n        //         nMapRow         : \"\",\r\n        //         nMapCol         : \"\",\r\n        //         loading1        : \"\",\r\n        //     }\r\n        //     cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(jsonData);\r\n        //     //加载多人选择界面\r\n        //     cc.director.loadScene(\"PersonsChoose\");\r\n        // }.bind(this));\r\n        // //监听游戏暂时退出按钮\r\n        // this.overMenu.getChildByName(\"quit\").on(\"touchstart\",function(){\r\n        //     //加载多人匹配界面\r\n        //     cc.director.loadScene(\"PersonsChoose\");\r\n        // });\r\n        // //监听再来一局按钮\r\n        // this.overMenu.getChildByName(\"again\").on(\"touchstart\",function(){\r\n        //     //加载多人匹配界面\r\n        //     cc.director.loadScene(\"PersonsChoose\");\r\n        // });\r\n        // this.overMenu.getChildByName(\"share\").on(\"touchstart\",function(){\r\n        //     //战绩分享\r\n            \r\n        // });\r\n        \r\n        //监听敌人是否下落成功\r\n        this.rivalTouchBarry = false;\r\n        //敌人是否落地\r\n        this.isTouch = false;\r\n        //是不是处于惩罚状态\r\n        this.isPunish = false;\r\n        this.invokeRemoveTime = 0;\r\n        //游戏结束是否已经处理过了\r\n        this.hasOver = false;\r\n        //检查自己是否胜利\r\n        this.isWin = false;\r\n    },\r\n    noticeFun : function(){\r\n        this.handNode.active = false;\r\n        this.darkNode.active =false;\r\n        this.noticeButton.active = false;\r\n        this.showNoticeHelp = false;\r\n    },\r\n    registerKeyBoard : function(){\r\n        //是否在滑动节点上\r\n        this.onSlide = false;\r\n        this.onGameSlide = false;\r\n        var self = this;\r\n        //注册键盘监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n        //滑动按钮监听\r\n        this.slideButton.on(\"touchstart\",function(event){\r\n            // this.onSlide = true;\r\n            //获得当前点击的全局坐标\r\n            this.slideButton.children[0].opacity = 120;\r\n            // self.slidePosition = event.getLocation();\r\n            cc.log(\"self.slidePositionX is \" + self.slidePositionX);\r\n        }.bind(this));\r\n        //在滑动节点上移动的时候\r\n        this.slideButton.on(\"touchmove\",function(event){\r\n            this.onSlide = true;\r\n            //获得当前点击的全局坐标\r\n            this.slideButton.children[0].opacity = 120;\r\n            self.slidePosition = event.getLocation();\r\n            cc.log(\"slidePositionX is \" + self.slidePositionX);\r\n        }.bind(this));\r\n        this.slideButton.on(\"touchcancel\",function(event){\r\n            //获得当前点击的全局坐标\r\n            this.slideButton.children[0].opacity = 0;\r\n            self.slidePosition = event.getLocation();\r\n            this.onSlide = false;\r\n        }.bind(this));\r\n        //在滑动节点上离开的时候\r\n        this.slideButton.on(\"touchend\",function(event){\r\n             //获得当前点击的全局坐标\r\n            this.slideButton.children[0].opacity = 0;\r\n            self.slidePosition = event.getLocation();\r\n            this.onSlide = true;\r\n        }.bind(this));\r\n\r\n         // 滑动节点上方的空节点\r\n         this.gameSlide.on(\"touchstart\",function(event){\r\n            cc.log(\"点击了gameSlide节点\");\r\n        }.bind(this));\r\n        this.gameSlide.on(\"touchmove\",function(event){\r\n            this.onGameSlide = true;\r\n            self.gameSlidePosition = event.getLocation();\r\n        }.bind(this));\r\n        this.gameSlide.on(\"touchend\",function(event){\r\n            this.onGameSlide = true;\r\n            self.gameSlidePosition = event.getLocation();\r\n        }.bind(this));\r\n        this.gameSlide.on(\"touchcancel\",function(event){\r\n            this.onGameSlide = false;\r\n            self.gameSlidePosition = event.getLocation();\r\n        }.bind(this));\r\n    },\r\n    //返回触点对应的列数\r\n    getTouchLine : function(touchNode,worldPosition){\r\n         //将触点的x坐标转化为本地坐标系\r\n         var localX = touchNode.convertToNodeSpaceAR(cc.v2(worldPosition.x,worldPosition.y)).x;\r\n         cc.log(\"local is \" + localX);\r\n         if(localX > 0){\r\n              var n1 = Math.floor(localX/(touchNode.width/6));\r\n              if(n1 >= 0 && n1 < 1){\r\n                  this.nCol = 3;\r\n              }else if(n1 >= 1 && n1 < 2){\r\n                  this.nCol = 4;\r\n              }else if(n1 >= 2 && n1 < 3){\r\n                  this.nCol = 5;\r\n              }\r\n         }else if(localX < 0){\r\n             var n2 = Math.floor(-localX/(touchNode.width/6));\r\n             if(n2 >= 0 && n2 < 1){\r\n                this.nCol = 2;\r\n            }else if(n2 >= 1 && n2 < 2){\r\n                this.nCol = 1;\r\n            }else if(n2 >= 2 && n2 < 3){\r\n                this.nCol = 0;\r\n            }\r\n         }\r\n         return this.nCol;\r\n    },\r\n    onKeyDown : function(event){\r\n        switch(event.keyCode){\r\n            case cc.KEY.down:\r\n                this.xltime = this.quickSpeed;\r\n                 break;\r\n            case cc.KEY.left:\r\n                 this.moveLeft();\r\n                 cc.log(\"<-----\");\r\n                 break;\r\n            case cc.KEY.right:\r\n                 this.moveRight();\r\n                 cc.log(\"----->\");\r\n                 break;  \r\n            case cc.KEY.f:\r\n                 this.rotate();\r\n                 //旋转操作\r\n                 break;                  \r\n        }\r\n    },\r\n    onKeyUp   : function(event){\r\n        switch(event.keyCode){\r\n            case cc.KEY.down:\r\n                this.xltime = this.normalSpeed;\r\n                 break;\r\n            case cc.KEY.left:\r\n                 break;\r\n            case cc.KEY.right:\r\n                 break;  \r\n            case cc.KEY.f:\r\n                 //旋转操作\r\n                 break;                 \r\n        }\r\n    },\r\n    onDestroy () {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    },\r\n    start () {\r\n\r\n    },\r\n    createRandomX : function(randomNumber){\r\n        return this.backGroundArr[0][randomNumber];\r\n    },\r\n    //产生随机数\r\n    createRandom : function(min,max){\r\n         return Math.floor(Math.random()*(max - min) + min);\r\n    },\r\n    //初始化游戏场景主背景12行6列的网格\r\n    /**\r\n     * @param  {外框上边缘的厚度} up\r\n     * @param  {外框左右边缘的厚度} lr\r\n     * @param  {背景网格的预制体} back\r\n     * @param  {行数} row\r\n     * @param  {列数} col\r\n     */\r\n    initMap : function(up,lr,back,row,col){\r\n        //初始化y坐标\r\n        var y = this.nodeHeight/2 - this.girdSize/2 - up;\r\n        //初始化x坐标\r\n        var x = -this.nodeWidth/2 + this.girdSize/2 + lr;\r\n        console.log(\"--->>>>x is \" + x);\r\n        console.log(\"--->>>>row is \" + row);\r\n        console.log(\"--->>>>col is \" + col);\r\n        this.backGroundArr = [];\r\n        this.map = [];\r\n        //12行6列的网格\r\n        for(var i = 0;i < row; i++){\r\n            //设置它的y坐标\r\n            var tempY =y - i * this.girdSize - 1;\r\n            tempY = Number(tempY.toFixed(2));\r\n            console.log(\"--->>>>tempY is \" + tempY);\r\n            this.backGroundArr[i] = [];\r\n            this.map[i] = [];\r\n            for(var j = 0; j < col;j++){\r\n                var outArr = this.backGroundArr[i];\r\n                var mapData = this.map[i];\r\n                var tempX = x + j * this.girdSize + 1;\r\n                tempX = Number(tempX.toFixed(2));\r\n                console.log(\"--->>>>tempX is \" + tempX);\r\n                //y坐标不变，x坐标要变\r\n                var tempPrefab = this.setPrefabPosition(back,tempX,tempY,this.node);\r\n                if(arguments.length === 6){\r\n                    tempPrefab.getComponent(arguments[5]).isFilled = 0;\r\n                    // tempPrefab.isFilled = 0;\r\n                    // console.log(\"tempPrefab.isFilled is \" + tempPrefab.isFilled);\r\n                    tempPrefab.getComponent(arguments[5]).type = -1;\r\n                    tempPrefab.getComponent(arguments[5]).innerNode = null;\r\n                }else if(arguments.length === 5){\r\n                    // var node = new Shape(tempPrefab,-1);\r\n                    tempPrefab.getComponent(\"Back\").isFilled = 0;\r\n                    // tempPrefab.isFilled = 0;\r\n                    // console.log(\"tempPrefab.isFilled is \" + tempPrefab.isFilled);\r\n                    tempPrefab.getComponent(\"Back\").type = -1;\r\n                    tempPrefab.getComponent(\"Back\").innerNode = null;\r\n                }\r\n                \r\n                // var shape = new Shape(tempPrefab,-1);\r\n                outArr[j]=tempPrefab;\r\n                mapData[j] = 0;\r\n            }\r\n        }\r\n        console.log(\"backGroundArr is \" +this.backGroundArr);\r\n    },\r\n    //生成形状在这个节点数组中加入父节点\r\n    initImage : function(parentNode,addJsonData){\r\n        this.times = 0;\r\n        //动态生成一个新的节点将生成的预制体节点加入到该父节点上\r\n        // var newNode = new cc.Node();\r\n        // parentNode.addChild(newNode);\r\n        //用来存放预制体的数组\r\n        //定义从哪一列开始下落\r\n        if(addJsonData === null){\r\n            var randomCol = game3.prototype.createRandom(2,4);\r\n        }else{\r\n            //如果是惩罚的话获得在哪一列开始惩罚\r\n            var randomCol = addJsonData.col;\r\n        }\r\n        var prefabArrTemp = [];\r\n        this.cishu  = 0;\r\n        //是否生成成功并且全部显示完毕\r\n        this.isCreateOver = false;\r\n        var loopCount = 2;\r\n        //从上往下生成\r\n        if(addJsonData === null){\r\n            loopCount = 2;\r\n        }else{\r\n            //获得生成惩罚方块的个数\r\n            loopCount = addJsonData.generateCount;\r\n        }\r\n        // var y = this.nodeHeight/2 + this.girdSize/2+1*this.girdSize;\r\n        for(var i = 0;i < loopCount;i++){\r\n            // var offSet = i * this.prefabHeight;\r\n            // cc.log(\"offSet is \" + offSet);\r\n            // //产生0-8的随机数\r\n            if(addJsonData === null){\r\n                var index = this.controlRandom();\r\n            }else{\r\n                var index = addJsonData.punishType;\r\n            }\r\n            // //将对应的颜色索引存放到该数组中\r\n            // // this.boxColorArr.push(this.prefabArr[index].color);\r\n            // cc.log(\"index is \" + index);\r\n            // //将对应的预制体取出来转化为节点然后显示\r\n            var prefabNode = game3.prototype.createPrefab(this.imagePrefabArr[index]);\r\n            // cc.log(\"x is \" + x + \" and y is \"+ y - offSet);\r\n            //设置预制节点的位置\r\n            prefabNode.setPosition(this.backGroundArr[0][randomCol].x,this.backGroundArr[0][randomCol].y);\r\n            cc.log(\"prefabNode is \" + prefabNode);\r\n            prefabNode.getComponent(\"Figure\").type = index;\r\n            prefabNode.getComponent(\"Figure\").col = randomCol;\r\n            prefabNode.getComponent(\"Figure\").row = 0;\r\n            prefabNode.active = false;\r\n            // this.backGroundArr[i][randomCol].node = prefabNode;\r\n            cc.log(\"------type is \" + prefabNode.getComponent(\"Figure\").type);\r\n            //将该预制节点添加为parentNode的孩子\r\n            parentNode.addChild(prefabNode);\r\n            // var shape = new Shape(prefabNode,index);\r\n            //将当前预制体节点存放到预制体临时数组里面\r\n            prefabArrTemp.push(prefabNode);\r\n        }\r\n        console.log(prefabArrTemp);\r\n        //生成父节点\r\n        return prefabArrTemp;\r\n    },\r\n    //改变随机数出现的概率\r\n    controlRandom : function(){\r\n        var id;\r\n        var rnd = Math.random();\r\n        if(rnd < 0.15){\r\n            id = 0;\r\n        }else if(rnd < 0.3){\r\n            id = 1;\r\n        }else if(rnd < 0.45){\r\n            id = 2;\r\n        }else if(rnd < 0.6){\r\n            id = 3;\r\n        }else if(rnd < 0.7){\r\n            id = 4;\r\n        }else if(rnd < 0.8){\r\n            id = 5;\r\n        }else if(rnd < 0.9){\r\n            id = 6;\r\n        }else if(rnd < 1){\r\n            id = 7;\r\n        }\r\n        return id;\r\n    },\r\n    //生成下一个形状\r\n    createNext : function(){\r\n        if(this.next2Block === undefined){\r\n            this.nextBlock = this.generateNext(this.node);\r\n            //显示下一个形状\r\n            this.showNextShape(this.nextBlock,this.nextShape);\r\n        }\r\n        // //生成下下个形状\r\n        // this.next2Block = this.generateNext(this.node);\r\n        // //显示下下个形状\r\n        // this.showNextShape(this.next2Block,this.next2);\r\n    },\r\n    //生成下一个形状\r\n    generateNext : function(parentNode){\r\n        return this.initImage(parentNode,null);\r\n    },\r\n    //显示下一个形状\r\n    showNextShape : function(nextBlock,parentNode){\r\n        //显示下一个形状之前删除这个节点的所有子节点\r\n        if(parentNode.childrenCount > 0){\r\n            for(let k = 0;k<parentNode.childrenCount;k++){\r\n                //销毁该子节点,如果销毁节点成功的话就显示下一个形状\r\n                parentNode.children[k].destroy();\r\n            }\r\n        }\r\n        //依次生成预制节点组成的节点数组\r\n        for(let i = 0;i<2;i++){\r\n            var type = nextBlock[i].getComponent(\"Figure\").type;\r\n            // var spriteFrame = nextBlock[i].getComponent(\"cc.Sprite\").spriteFrame;\r\n            this.setPrefabPosition(this.imagePrefabArr[type],0,60-i*this.girdSize,parentNode);\r\n        }\r\n        // for(let k = 0;k<3;k++){\r\n        //     var pre = ;\r\n        //     this.setPrefabPosition(,50,50+k*this.prefabHeight,this.nextShape);\r\n        // }\r\n    },\r\n     /**\r\n    @param prefab:将要生成预制节点的预制体\r\n    @param x     :将要生成预制节点的x坐标\r\n    @param y     :将要生成预制节点的y坐标\r\n    @param parentNode : 生成的预制节点的父节点\r\n     */\r\n    setPrefabPosition : function(prefab,x,y,parentNode){\r\n        var prefab = this.createPrefab(prefab);\r\n        prefab.setPosition(x,y);\r\n        parentNode.addChild(prefab);\r\n        return prefab;\r\n    },\r\n    //创建一个预制体节点\r\n    createPrefab : function(prefab){\r\n        var prefabNode = cc.instantiate(prefab);\r\n        return prefabNode;\r\n    },\r\n    //查看当前的棍处于哪一列\r\n    getColumn : function(node){\r\n        //竖行的条\r\n        var indexGrid = this.chooseColumnByLocation(node.x);\r\n        //放回列号\r\n        return indexGrid;\r\n    },\r\n    //根据坐标选择位于哪个列\r\n    chooseColumnByLocation : function(x){\r\n        switch(x){\r\n            case this.backGroundArr[0][0].x:\r\n                return 0;\r\n            case this.backGroundArr[0][1].x:\r\n                return 1;\r\n            case this.backGroundArr[0][2].x: \r\n                return 2;\r\n            case this.backGroundArr[0][3].x: \r\n                return 3;\r\n            case this.backGroundArr[0][4].x:\r\n                return 4;\r\n            case this.backGroundArr[0][5].x:\r\n                return 5;                 \r\n        }\r\n    },\r\n    //根据坐标获得位于哪一行\r\n    getRow : function(node){\r\n        var yIndexResult;\r\n        cc.log(\"node is \" + node);\r\n        yIndexResult = this.chooseRawByLocation(node.y);\r\n        return yIndexResult;\r\n    },\r\n    /***\r\n        根据y坐标数值得到对应的行\r\n        返回对应的行数\r\n        @param : y 传入方法中的y坐标\r\n        @return 返回坐标对应的行号\r\n    * */\r\n    chooseRawByLocation : function(y){\r\n        switch(y){\r\n            case this.backGroundArr[11][0].y:\r\n                return 11;\r\n            case this.backGroundArr[10][0].y:\r\n                return 10;\r\n            case this.backGroundArr[9][0].y: \r\n                return 9;\r\n            case this.backGroundArr[8][0].y: \r\n                return 8;\r\n            case this.backGroundArr[7][0].y:\r\n                return 7;\r\n            case this.backGroundArr[6][0].y:\r\n                return 6;\r\n            case this.backGroundArr[5][0].y:\r\n                return 5;\r\n            case this.backGroundArr[4][0].y:\r\n                return 4;\r\n            case this.backGroundArr[3][0].y: \r\n                return 3;\r\n            case this.backGroundArr[2][0].y: \r\n                return 2;\r\n            case this.backGroundArr[1][0].y:\r\n                return 1;\r\n            case this.backGroundArr[0][0].y:\r\n                return 0;    \r\n        }\r\n    },\r\n    getNodeArrMaxCol : function(){\r\n        var maxCol;\r\n        var colArr = [];\r\n        for(let i = 0;i<this.nodeArr.length;i++){\r\n            colArr.push(this.nodeArr[i].getComponent(\"Figure\").col);\r\n        }\r\n        maxCol = Math.max.apply(Math,colArr);\r\n        //返回最大列\r\n        return maxCol;\r\n    },\r\n    getNodeArrMinCol : function(){\r\n        var minCol;\r\n        var colArr = [];\r\n        for(let i = 0;i<this.nodeArr.length;i++){\r\n            colArr.push(this.nodeArr[i].getComponent(\"Figure\").col);\r\n        }\r\n        minCol = Math.min.apply(Math,colArr);\r\n        //返回最小列\r\n        return minCol;\r\n    },\r\n    update (dt) {\r\n        //当提示信息显示的时候游戏不会运行\r\n        if(!this.showNoticeHelp){\r\n            if(this.onSlide || this.onGameSlide){\r\n                if(this.onSlide){\r\n                    var column = this.getTouchLine(this.slideButton,this.slidePosition);\r\n                    this.onSlide = false;\r\n                }else{\r\n                    var column = this.getTouchLine(this.gameSlide,this.gameSlidePosition);\r\n                    this.onGameSlide = false;\r\n                }\r\n                //如果当前列比节点数组中最大列还大的话就右移\r\n                if(column > this.getNodeArrMaxCol()){\r\n                    //右移\r\n                    this.moveRight();\r\n                }else if(column < this.getNodeArrMinCol()){\r\n                    //左移\r\n                    this.moveLeft();\r\n                }\r\n            }\r\n            switch(this.status){\r\n                case statuMachine.STATE_BEGIN:\r\n                 cc.log(\"开始游戏\");\r\n                 break;\r\n                case statuMachine.STATE_PLAY:\r\n                 cc.log(\"游戏中\");  \r\n            }\r\n            //如果游戏结束了就不在进行下落\r\n            if(!this.gameOver){\r\n                this.san += dt;\r\n                this.time += dt; \r\n                if(this.cishu === 0 && this.xltime < this.normalSpeed){\r\n                    this.xltime = this.normalSpeed;\r\n                }\r\n                if(this.time > this.xltime){\r\n                    if(this.cishu < 2){\r\n                        //这种情况不让它旋转\r\n                        if(this.cishu === 0){\r\n                            if(this.map[0][this.nodeArr[1].getComponent(\"Figure\").col] === 1){\r\n                                this.gameOver = true;\r\n                            }else{\r\n                                this.nodeArr[1].active = true;\r\n                                let sendJsonData = {\r\n                                    row : 0,\r\n                                    col : this.nodeArr[1].getComponent(\"Figure\").col,\r\n                                    color : this.nodeArr[1].getComponent(\"Figure\").type.toString(),\r\n                                }\r\n                                console.log(\"this.jsonMsgToServer is \" + this.jsonMsgToServer);\r\n                                console.log(\".................消除之后为什么不能下落................\");\r\n                                this.jsonMsgToServer.changeMapList1.push(sendJsonData);\r\n                                //发送数据到服务器\r\n                                this.jsonMsgToServer.score = this.score;\r\n                                this.sendDown = true;\r\n                            }\r\n                        }else if(this.cishu === 1){\r\n                            if(this.map[1][this.nodeArr[1].getComponent(\"Figure\").col] != 1){\r\n                                this.nodeArr[1].y = this.backGroundArr[1][this.nodeArr[1].getComponent(\"Figure\").col].y;\r\n                                this.nodeArr[1].getComponent(\"Figure\").row = 1;\r\n                                this.nodeArr[0].active = true;\r\n                                this.nodeArr[0].y = this.backGroundArr[0][this.nodeArr[0].getComponent(\"Figure\").col].y;\r\n                                this.nodeArr[0].getComponent(\"Figure\").row = 0;\r\n                                // let arr = [];\r\n                                let sendJsonData1 = {\r\n                                    row : 1,\r\n                                    col : this.nodeArr[1].getComponent(\"Figure\").col,\r\n                                    color : this.nodeArr[1].getComponent(\"Figure\").type.toString(),\r\n                                }\r\n                                let sendJsonData0 = {\r\n                                    row : 0,\r\n                                    col : this.nodeArr[0].getComponent(\"Figure\").col,\r\n                                    color : this.nodeArr[0].getComponent(\"Figure\").type.toString(),\r\n                                }\r\n                                this.jsonMsgToServer.changeMapList1.push(sendJsonData1);\r\n                                this.jsonMsgToServer.changeMapList1.push(sendJsonData0);\r\n                                this.jsonMsgToServer.score = this.score;\r\n                                this.sendDown = true;\r\n                                \r\n                            }else{\r\n                                this.gameOver = true;\r\n                            }\r\n                        }\r\n                        this.cishu++;\r\n                        //表示节点数组已经生成完毕可以进行旋转操作\r\n                        if(this.cishu === 2){\r\n                            //两个方块已经生成完毕\r\n                            this.isCreateOver = true;\r\n                        }\r\n                    }else{\r\n                        //更新节点的位置信息\r\n                        this.updatePrefatY(this.nodeArr);\r\n                    }\r\n                    this.time = 0;\r\n                }\r\n                /**\r\n                 * 发送给服务器数据开始\r\n                 */\r\n                //发送下落的数据\r\n                if(this.sendDown){\r\n                   this.sendChangeDataToServer();\r\n                    //发送完毕关闭该开关\r\n                   this.sendDown = false;\r\n                }\r\n                //发送向左移动的数据\r\n                if(this.sendLeft){\r\n                   this.sendChangeDataToServer();\r\n                   this.sendLeft = false;\r\n                }\r\n                //发送向右移动的数据\r\n                if(this.sendRight){\r\n                   this.sendChangeDataToServer();\r\n                   this.sendRight = false;\r\n                }\r\n                //发送旋转的相关数据\r\n                if(this.sendRotate){\r\n                    this.sendChangeDataToServer();\r\n                    this.sendRotate = false;\r\n                }\r\n                /**\r\n                 * 发送给服务器数据结束\r\n                 */\r\n            }else {\r\n                // //自己的游戏状态为是否游戏结束重置为true\r\n                // cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").isOver = true;\r\n                //自己被敌人打败\r\n                if(!this.hasOver){\r\n                    console.log(\"进入自己失败的游戏界面\");\r\n                    if(!this.isWin){\r\n                        this.gameBye();\r\n                    }\r\n                }\r\n            \r\n            }\r\n        }\r\n        //监听敌人是不是被自己打败\r\n    },\r\n    sendChangeDataToServer : function(){\r\n        cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n        console.log(\"================发送数据结束================\");\r\n        this.jsonMsgToServer.changeMapList1 = [];\r\n    },\r\n    //游戏结束是否是被敌人打败\r\n    gameBye : function(){\r\n        //播放失败音效\r\n        this.playAudio(this.loseAudio);\r\n        //其他下降，旋转按钮，左右移动按钮处于不可激活状态\r\n        this.downButton.interactable = false;\r\n        this.rotateButton.interactable = false;\r\n        this.slideButton.interactable = false;\r\n        //显示结束动画\r\n        this.gameOverAnimation.active = true;\r\n        // var animation = this.gameOverAnimation.getComponent(cc.Animation);\r\n        // animation.play(\"Over_light\"); \r\n        this.overMenu.active = true;\r\n        this.mask.active = true;\r\n        //自己失败显示失败\r\n        this.overMenu.getChildByName(\"lose\").active = true;\r\n        //自己没有赢不显示胜利的标记\r\n        this.overMenu.getChildByName(\"win\").active = false;\r\n        //显示分数\r\n        this.overMenu.getChildByName(\"Score\").getComponent(cc.Label).string = this.score.toString();\r\n        //显示等级\r\n        //游戏结束向服务器发送游戏结束事件\r\n        //被对手打败发送消息到服务器\r\n        //被敌人打败发送消息到服务器告诉服务器我输了\r\n        var gameOverJson = {\r\n            tag1            : 4,\r\n            score           : \"\",\r\n            type            : \"4\",\r\n            state1          : \"\",\r\n            changeMapList1  : [],\r\n            removeMapList1  : 0,\r\n            nMapRow         : \"\",\r\n            nMapCol         : \"\",\r\n            loading1        : \"\",\r\n            result_score    : \"\",\r\n        }\r\n        //告诉对方我的游戏结束了\r\n        var gameOverJson1 = {\r\n            tag1            : 13,\r\n            score           : \"\",\r\n            type            : \"4\",\r\n            state1          : \"\",\r\n            changeMapList1  : [],\r\n            removeMapList1  : 0,\r\n            nMapRow         : \"\",\r\n            nMapCol         : \"\",\r\n            loading1        : \"\",\r\n            result          : -1,\r\n        }\r\n        gameOverJson.result_score = this.score.toString();\r\n        console.log(\"进入游戏结束给服务器发送游戏结束信息\");\r\n        //如果游戏结束没有发送给服务器发送一次\r\n        cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(gameOverJson);\r\n        cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(gameOverJson1);\r\n        // this.overCost += dt;\r\n        //游戏结束已经处理过了\r\n        this.hasOver = true;\r\n        //显示广告内容\r\n        cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").showAdvice();\r\n        //暂停游戏\r\n        cc.director.pause();\r\n    },\r\n    //更新预制体节点的y坐标\r\n    updatePrefatY : function(nodeArr){\r\n                var self = this;\r\n                //如果允许下落的话条的y坐标向下移动\r\n                if(this.CheckIsDown(nodeArr)){\r\n                        //下落节点数组,如果是横向的话分开这连个节点\r\n                        this.down(nodeArr);\r\n                }else{\r\n                    console.log(\"对手是否触底---->>>> \"+ this.rivalTouchBarry); \r\n                    if(this.rivalTouchBarry){\r\n                        console.log(\"对手触底了吗？\",this.rivalTouchBarry);\r\n                        // console.log(\"$$$$$$$$$$$$$$$$$$$$$$$$$$$$>>>>>>>>>>>>>Enter the rivalTouchBarry\");\r\n                        //如果对手碰到障碍物了就将isTouch重置为true\r\n                        this.isTouch = true;\r\n                        //改变地图信息\r\n                        this.changeMap(this.nodeArr);\r\n                        var removeTime = 0;\r\n                        //发送给服务器的惩罚所需要的数据\r\n                        var removeJsonToServerWithPunish = {\r\n                            tag1            : 12,\r\n                            score           : \"\",\r\n                            type            : \"4\",\r\n                            state1          : \"\",\r\n                            changeMapList1  : [],\r\n                            removeRow       : 0,\r\n                            nMapRow         : \"\",\r\n                            nMapCol         : \"\",\r\n                            loading1        : \"\",\r\n                        }\r\n                        console.log(\"准备发送数据hahahahahahhaah\");\r\n                        function next(data){\r\n                            //处于闭包环境下该方法需要绑定对象\r\n                            //计算消除的次数\r\n                            removeJsonToServerWithPunish.removeRow = data;\r\n                            //发送惩罚相关数据\r\n                            console.log(\"============================发送惩罚相关数据到服务器\");\r\n                            cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(removeJsonToServerWithPunish);\r\n                            //惩罚完毕关闭惩罚\r\n                            self.isPunish = false;\r\n                            //监听对手是否触底开关关闭\r\n                            self.rivalTouchBarry = false;\r\n                            self.invokeRemoveTime = 0;\r\n                        } \r\n                        //异步操作       \r\n                        self.checkNodeArr(self.nodeArr,removeTime).then(function(){\r\n                            console.log(\"最终的消除次数是：\" + removeTime);\r\n                            console.log(\"在更新预制体坐标位置的全局消除次数是\",self.invokeRemoveTime);\r\n                            next(self.invokeRemoveTime);\r\n                        });\r\n                        console.log(\"消除惩罚开关是否关闭\",self.isPunish);\r\n                        console.log(\"消除监听对手惩罚开关是否关闭\",self.rivalTouchBarry);\r\n                        //消除次数是\r\n                        console.log(\"准备给服务器发送12消息 消除次数是-----\",removeTime);\r\n                        //等待上一步的异步操作\r\n                        console.log(\"?????????????????????/////消除发送给服务器数据\");\r\n                    }else{\r\n                        console.log(\"::::::::this.rivalTouchBarry\");\r\n                        console.log(\"对手触底了吗？\",this.rivalTouchBarry);\r\n                        //改变地图信息\r\n                        this.changeMap(this.nodeArr);\r\n                        var removeTime = 0;\r\n                        //消除个数或者是消除次数发给服务器\r\n                        var removeJsonToServer = {\r\n                            tag1            : 6,\r\n                            score           : \"\",\r\n                            type            : \"4\",\r\n                            state1          : \"\",\r\n                            changeMapList1  : [],\r\n                            removeMapList1  : [],\r\n                            nMapRow         : \"\",\r\n                            nMapCol         : \"\",\r\n                            loading1        : \"\",\r\n                        }\r\n                        function next(data){\r\n                            let jsonR = {\r\n                                row : data,\r\n                                col : 0,\r\n                            };\r\n                            removeJsonToServer.removeMapList1.push(jsonR);\r\n                            //向服务器发送消除的次数以便进行惩罚\r\n                            console.log(\"在next方法中消除次数是\"+ jsonR.data);\r\n                            cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(removeJsonToServer);\r\n                            //重置消除次数\r\n                            self.invokeRemoveTime = 0;\r\n                        } \r\n                        self.checkNodeArr(self.nodeArr,removeTime).then(function(){\r\n                            console.log(\"最终的消除次数是：\"+ removeTime);\r\n                            console.log(\"在更新预制体坐标位置的全局消除次数是\",self.invokeRemoveTime);\r\n                            if(self.invokeRemoveTime != 0){\r\n                                next(self.invokeRemoveTime);\r\n                            }\r\n                        });\r\n                        // function waitCheck(){\r\n                        //     //查看这个节点数组中是否可以消除如果满足条件进行消除返回一个Promise对象\r\n                        //     return self.checkNodeArr(self.nodeArr,removeTime);\r\n                        // }       \r\n                        // waitCheck().then(function(data){\r\n                        //     //检查完成之后进行下一步操作\r\n                        //     // console.log(\"记录递归调用的次数是\"+this.invokeRemoveTime);\r\n                        //     // console.log(\"then 操作----->>>\",data);\r\n                        //     console.log(\"消除次数是：\"+removeTime);\r\n                        //     //如果消除的次数为零的话该数据不发送给服务器\r\n                        //     if(removeTime != 0){\r\n                        //         //消除次数不为零的情况发送给服务器\r\n                        //         next(removeTime);\r\n                                \r\n                        //     }\r\n                        // });   \r\n                        //等待上一步的异步操作上一步的异步操作完成之后给服务器发送数据\r\n                    }\r\n                    //如果是不在惩罚状态的话就正常下落如果是处于惩罚状态的话就等待惩罚进行完毕之后进行下落\r\n                    \r\n                    //生成下一个形状\r\n                    self.nodeArr = self.nextBlock;\r\n                    //生成下一个形状\r\n                    self.createNext();\r\n                    \r\n                }\r\n    },\r\n    share : function(){\r\n        if(CC_WECHATGAME){\r\n            console.log(\"首页share\");\r\n            cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").shareFriends();\r\n        }else if(cc.sys.isNative){\r\n            //原生平台分享\r\n            cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").nativeShare();\r\n        }\r\n    },\r\n    //检查一个节点数组是否满足消除条件\r\n    checkNodeArr : function(nodeArr,removeTime){\r\n        var self = this;\r\n        if(nodeArr.length > 0){\r\n            //临时数组存放待消节点\r\n            var waitQueue = [];\r\n            if(this.canRemove(nodeArr,waitQueue).isRemove){\r\n                //如果是可以消除的话进行消除这时候待消队列已经填满了节点\r\n                // this.remove(this.nodeArr);\r\n                //检测完这两个下落的方块的待消队列\r\n                for(let j = 0;j<waitQueue.length;j++){\r\n                    //如果该节点已经删除的话不对它操作\r\n                    if(waitQueue[j] === null){\r\n                        //将它从该数组删除\r\n                        waitQueue.splice(j,1);\r\n                    }\r\n                    //将这些待消除的标记为可消除的\r\n                    waitQueue[j].getComponent(\"Figure\").isRemove = true;\r\n                }\r\n                this.tempNodes = waitQueue;\r\n                //加分\r\n                this.addScore(waitQueue.length);\r\n                return self.remove(waitQueue,removeTime).then(function(data){\r\n                    console.log(\"在检查节点的时候消除次数是：\",removeTime);\r\n                    console.log(\"上一次remove执行完毕\");\r\n                });\r\n                // return new Promise(function(resolve,reject){\r\n                //     //检测是否可以消除操作\r\n                //     var b = self.remove(waitQueue,removeTime);\r\n                //     console.log(\"b is \",b);\r\n                //     if(b){\r\n                //         //如果消除完毕就告诉Promise执行完毕了\r\n                //         resolve(removeTime);\r\n                //     }\r\n                //     // resolve(removeTime);\r\n                // });\r\n            }else{\r\n                //不能消除的时候发送零\r\n                if(this.rivalTouchBarry){\r\n                    console.log(\"对手不能消除在发送消息给服务器！！！！！！\");\r\n                    // callback(0);\r\n                    return new Promise(function(resolve,reject){\r\n                        console.log(\"进入消除零次的Promise\");\r\n                        resolve(0);\r\n                    });\r\n                }else{\r\n                    //如果是自己的话消除零次发送给服务器但是在不能下落的时候不发送该数据\r\n                    return new Promise(function(resolve,reject){\r\n                        console.log(\"对手没有给我发消息\");\r\n                        resolve(0); \r\n                    });\r\n                }\r\n            }\r\n            \r\n           \r\n            \r\n        }\r\n        \r\n    },\r\n    //消除操作，先播放消除动画删除相应节点，上面的节点依次下落\r\n    remove : function(waitQueue,removeTime){\r\n        //播放消除音效\r\n        this.playAudio(this.removeAudio);\r\n        //先不删除这些节点等找到所有这些待消节点上方的节点之后删除他们\r\n        //找到这几个待消节点上面的所有节点让他们自动执行下落动作（节点所挂的消除下落方法）\r\n        var scoreLabel = this.scoreLabel.getComponent(cc.Label);\r\n        removeTime++;\r\n        //记录消除次数\r\n        this.invokeRemoveTime++;\r\n        if(removeTime >= 2){\r\n            if(removeTime === 2){\r\n                //产生一次连击\r\n                this.score += 10;\r\n            }else if(removeTime === 3){\r\n                //产生两次连击\r\n                this.score += 20;\r\n            }else if(removeTime === 4){\r\n                //产生3次连击\r\n                this.score += 30;\r\n            }else if(removeTime === 5){\r\n                //产生4次连击\r\n                this.score += 40;\r\n            }else if(removeTime === 6){\r\n                this.score += 50;\r\n            }else if(removeTime === 7){\r\n                //六连击\r\n                this.score += 60;\r\n            }\r\n            scoreLabel.string = this.score.toString();\r\n        }\r\n        // this.jsonMsgToServer.removeMapList1 = removeTime;\r\n        // this.jsonMsgToServer.score = this.score.toString();\r\n        \r\n        var waitDownArr = [];\r\n        for(let m = 0;m<waitQueue.length;m++){\r\n            var cRow = waitQueue[m].getComponent(\"Figure\").row;\r\n            var cCol = waitQueue[m].getComponent(\"Figure\").col;\r\n            this.upFindNodes(cRow,cCol,waitDownArr);\r\n        }\r\n        cc.log(\"待下落节点数组为：\" + waitDownArr);\r\n        //得到激活之后的节点\r\n        var activeNode = this.deleteNodeFromParent(waitQueue);\r\n        // if(!waitDownArr.contain(activeNode))\r\n        //     waitDownArr.push(activeNode);\r\n        //下落其他节点\r\n        for(let j = 0;j<waitDownArr.length;j++){\r\n             waitDownArr[j].getComponent(\"Figure\").afterRemoveDown(this.map,this.backGroundArr,true);\r\n        }\r\n        if(activeNode.length > 0){\r\n            for(let i = 0;i<activeNode.length;i++){\r\n                if(!waitDownArr.contain(activeNode[i])){\r\n                    //将该激活节点加入到下降节点队列里检测是否可以再次消除\r\n                    waitDownArr.push(activeNode[i]);\r\n                }\r\n            }\r\n        }\r\n        // cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n        //检测下降的节点数组看看是否可以再次消除\r\n        //0.5秒后检测下落的节点数组，为了防止下落块还没有执行action完又来了个action这样moveTo方法会出现错误\r\n        //连消检测\r\n        var self = this;\r\n        function next(){\r\n            //向服务器发送分数信息\r\n            var jsonMsgToServer = {\r\n                tag1            : 11,\r\n                score           : 0,\r\n                type            : \"4\",\r\n                state1          : \"\",\r\n                changeMapList1  : [],\r\n                removeMapList1  : 0,\r\n                nMapRow         : \"\",\r\n                nMapCol         : \"\",\r\n                loading1        : \"\",\r\n                nDisappear1     : 0,\r\n            }\r\n            jsonMsgToServer.tag1 = 11;\r\n            jsonMsgToServer.score = self.score;\r\n            jsonMsgToServer.nDisappear1 = self.score;\r\n            cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(jsonMsgToServer);\r\n            // return true;\r\n        }\r\n        console.log(\"1031\");\r\n        function waitPromise(){\r\n            return new Promise(function(resolve,reject){\r\n                setTimeout(function(){\r\n                    console.log(\"1034 line \" + removeTime);\r\n                    //检查是否能再次消除\r\n                    var isP = self.checkNodeArr(waitDownArr,removeTime);\r\n                    if(isP instanceof Promise){\r\n                        console.log(\"1038 --->\" + isP);\r\n                        isP.then(function(data){\r\n                            resolve(data);\r\n                        });\r\n                    }\r\n                },500);\r\n            });\r\n        }\r\n        return waitPromise().then(function(data){\r\n            console.log(\"在消除方法中消除次数是\",removeTime);\r\n            console.log(\"全局的消除变量是\",self.invokeRemoveTime);\r\n            next();\r\n            // overPromise();\r\n        });\r\n        \r\n    },\r\n    //改变地图信息\r\n    changeMap : function(nodeArr){\r\n        if(nodeArr.length > 0){\r\n            for(let k = 0;k<nodeArr.length;k++){\r\n                //将所有的坐标变成只保留两位小数的数字\r\n                nodeArr[k].x = Number(nodeArr[k].x.toFixed(2));\r\n                nodeArr[k].y = Number(nodeArr[k].y.toFixed(2));\r\n            }\r\n            for(let i = 0;i<nodeArr.length;i++){\r\n                //当前停止的节点对应的地图位置\r\n                var row = nodeArr[i].getComponent(\"Figure\").row;\r\n                var col = nodeArr[i].getComponent(\"Figure\").col;\r\n                //如果有块在停止的时候更新了地图就不在这里更新地图信息了\r\n                if(!nodeArr[i].getComponent(\"Figure\").hasDown){\r\n                    this.map[row][col] = 1;\r\n                    //将背景方格的属性状态改为该节点数组对应的类型\r\n                    this.backGroundArr[row][col].getComponent(\"Back\").type = nodeArr[i].getComponent(\"Figure\").type;\r\n                    this.backGroundArr[row][col].getComponent(\"Back\").innerNode = nodeArr[i];\r\n                }else{\r\n                    //将该节点的移动状态改为初始值\r\n                    nodeArr[i].getComponent(\"Figure\").hasDown = false;\r\n                }\r\n                \r\n            }\r\n                \r\n        }\r\n    },\r\n    //检查该节点数组是否可以消除\r\n    /**\r\n     * @param  {待检测的节点数组} nodeArr\r\n     * @param  {待消队列} waitQueue\r\n     * @return {JSON}    result\r\n     */\r\n    canRemove : function(nodeArr,waitQueue){\r\n        //返回结果\r\n        var result = {\r\n            isRemove : false,\r\n            queue    : null,\r\n        }\r\n        for(let m = 0;m < nodeArr.length;m++){\r\n            var tempArr = [];\r\n            var cRow = nodeArr[m].getComponent(\"Figure\").row;\r\n            var cCol = nodeArr[m].getComponent(\"Figure\").col;\r\n            var cType = nodeArr[m].getComponent(\"Figure\").type;\r\n            this.find(nodeArr[m],cRow,cCol,cType,tempArr);\r\n            if(tempArr.length >= 3){\r\n                for(let k = 0;k < tempArr.length;k++){\r\n                    var nodeType = tempArr[k].getComponent(\"Figure\").type;\r\n                    //画像方块的类型在0-3之间才允许加进去\r\n                    if(!waitQueue.contain(tempArr[k]) && (nodeType < 4 && nodeType >= 0)){\r\n                        //如果数组里面有这个节点的信息了说明已经加到数组里面了不用再重复加入了\r\n                        waitQueue.push(tempArr[k]);\r\n                    }else{\r\n                        cc.log(\"该类型不在加入的条件\");\r\n                    }\r\n                    \r\n                }\r\n            }\r\n        }\r\n        //递归的方式把待消队列找出来\r\n        if(waitQueue.length >= 3){\r\n            result.isRemove = true;\r\n            result.queue = waitQueue;\r\n        }else{\r\n            result.isRemove = false;\r\n            result.queue = [];\r\n        }\r\n        return result;\r\n\r\n    },\r\n    /**\r\n     * 依据带消除队列里的长度进行计算分数\r\n     * @param  {待消除队列的长度} waitQueueLength\r\n     */\r\n    addScore : function(waitQueueLength){\r\n        var scoreLabel = this.scoreLabel.getComponent(cc.Label);\r\n        switch(waitQueueLength){\r\n            case 3:\r\n                this.score += 30;\r\n                break;\r\n            case 4:\r\n                this.score += 40;\r\n                break;\r\n            case 5:\r\n                this.score += 50;\r\n                break;\r\n            case 6:\r\n                this.score += 60;\r\n                break;\r\n            case 7:\r\n                this.score += 70;\r\n                break;\r\n            case 8:\r\n                this.score += 80;\r\n                break;\r\n            case 9:\r\n                this.score += 90;\r\n                break;                        \r\n        }\r\n        //显示分数\r\n        scoreLabel.string = this.score;\r\n    },\r\n    \r\n    /**\r\n     * @param  {待消除队列} waitQueue\r\n     */\r\n    deleteNodeFromParent : function(waitQueue){\r\n        //激活节点数组\r\n        var activeNodeArr = [];\r\n        var jsonMsgToServer = {\r\n            tag1            : 9,\r\n            score           : \"\",\r\n            type            : \"4\",\r\n            state1          : \"\",\r\n            changeMapList1  : [],\r\n            removeMapList1  : 0,\r\n            nMapRow         : \"\",\r\n            nMapCol         : \"\",\r\n            loading1        : \"\",\r\n            nDisappear1     : \"\", \r\n        };\r\n        for(let i = 0;i<waitQueue.length;i++){\r\n            var row = waitQueue[i].getComponent(\"Figure\").row;\r\n            var col = waitQueue[i].getComponent(\"Figure\").col;\r\n            // var upNodes = this.upFindNodes(row,col);\r\n            //检查待消除方格的周围有没有封印的方格小块\r\n            this.checkHasSealBlock(row,col,activeNodeArr);\r\n            //恢复地图信息\r\n            this.map[row][col] = 0;\r\n            //恢复背景方格的原始属性\r\n            this.backGroundArr[row][col].getComponent(\"Back\").type = -1;\r\n            this.backGroundArr[row][col].getComponent(\"Back\").innerNode = null;\r\n            waitQueue[i].getComponent(\"Figure\").shine();\r\n            let removeJsonInfo = {\r\n                row : row,\r\n                col : col,\r\n                color : \"-1\",\r\n            }\r\n            jsonMsgToServer.changeMapList1.push(removeJsonInfo);\r\n        }\r\n       \r\n        console.log(\"^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\");\r\n        console.log(...jsonMsgToServer.changeMapList1);\r\n        cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(jsonMsgToServer);\r\n        //返回激活队列\r\n        return activeNodeArr;\r\n        // if(activeNodeArr.length > 0){\r\n        //     //检查激活过的节点是否存在消除的可能\r\n        //     this.checkNodeArr(activeNodeArr);\r\n        // }\r\n    },\r\n    //查看一个节点周围有没有封印的画像方块\r\n    checkHasSealBlock : function(row,col,activeNodeArr){\r\n        //四个方向的位置\r\n        var directionArr = [[row-1,col],[row+1,col],[row,col-1],[row,col+1]];\r\n        for(let m = 0;m<directionArr.length;m++){\r\n            var crow = directionArr[m][0];\r\n            var ccol = directionArr[m][1];\r\n            //如果行或者列超出了边界位置就继续下一个方向数组对应的行和列\r\n            if(crow > 11 || crow < 0 || ccol > 5 || ccol < 0){\r\n                continue;\r\n            }else{\r\n                var node = this.backGroundArr[crow][ccol].getComponent(\"Back\").innerNode;\r\n                if(node === null){\r\n                    continue;\r\n                }\r\n                //如果是待消除的方块的话就跳过该节点\r\n                if(node.getComponent(\"Figure\").isRemove === true){\r\n                    continue;\r\n                }\r\n                var nodeType = this.backGroundArr[crow][ccol].getComponent(\"Back\").type;\r\n                if(nodeType >= 4 && nodeType <= 7){\r\n                    // var nodeName = Number(node.name);\r\n                    //证明该行该列存在封印的画像动态加载图片\r\n                    cc.log(\"nodeType is \" + nodeType);\r\n                    var anim = node.getComponent(cc.Animation);\r\n                    //激活状态设置为true\r\n                    node.getComponent(\"Figure\").isActive = true;\r\n                    if(!activeNodeArr.contain(node)){\r\n                        //将该激活节点加入到激活队列里\r\n                        activeNodeArr.push(node);\r\n                    }\r\n                    let sendJson = {\r\n                        row : crow,\r\n                        col : ccol,\r\n                        color : \"2\",\r\n                    }\r\n                    if(nodeType === 4){\r\n                        this.playAnimAndChangeState(anim,0,\"7\",crow,ccol,node,sendJson);\r\n                    }else if(nodeType === 5){\r\n                        this.playAnimAndChangeState(anim,1,\"8\",crow,ccol,node,sendJson);\r\n                    }else if(nodeType === 6){\r\n                        this.playAnimAndChangeState(anim,2,\"9\",crow,ccol,node,sendJson);\r\n                    }else if(nodeType === 7){\r\n                       this.playAnimAndChangeState(anim,3,\"10\",crow,ccol,node,sendJson);\r\n                    }  \r\n                    this.jsonMsgToServer.changeMapList1.push(sendJson);\r\n                    cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n                    //置空改变地图json对象数组\r\n                    this.jsonMsgToServer.changeMapList1 = [];\r\n                    console.log(\"=====================查找待激活的节点并将它传到服务器并且改变数组=========================\");\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n    /**\r\n     * 播放破壳动画及变换背景方格的类型\r\n     * @param  {动画对象} anim\r\n     * @param  {背景方格对应的类型} type\r\n     * @param  {该节点即将改变的名字} name\r\n     * @param  {待破壳节点的行} crow\r\n     * @param  {待破壳节点的列} ccol\r\n     * @param  {改变的节点} node\r\n     * @param  {发送给服务器的json数据} sendJson\r\n     */\r\n    playAnimAndChangeState : function(anim,type,name,crow,ccol,node,sendJson){\r\n        for(let j = 0;j<node.childrenCount;j++){\r\n            node.children[j].setPositionX(0);\r\n            node.children[j].active = true;\r\n        }\r\n        anim.play(\"game_yellow_stone_unlock\");\r\n        //改变背景方格的对应的状态类型\r\n        this.backGroundArr[crow][ccol].getComponent(\"Back\").type = type;\r\n        sendJson.color = type.toString();\r\n        //设置该节点的类型为0\r\n        node.getComponent(\"Figure\").type = type;\r\n        node.name = name;\r\n    },\r\n    //动态修改图片的spriteFrame\r\n    /**\r\n     * @param  {节点的名字} nodeName\r\n     * @param  {待修改节点} node\r\n     */\r\n    dynamicLoad : function(nodeName,node){\r\n        nodeName = Number(nodeName);\r\n        function callback(err,spriteFrame){\r\n            if(err){\r\n                console.log(err);\r\n            }\r\n            node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n            //加载完之后修改精灵的名字\r\n            cc.log(\"设置\");\r\n        }\r\n        (function test(callback){\r\n            cc.loader.loadRes(\"Game4/\" + nodeName-4,cc.SpriteFrame,callback);\r\n        })(callback.bind(this));\r\n    },\r\n    \r\n    //向上找节点\r\n    /**\r\n     * @param  {本节点的行} row\r\n     * @param  {本节点的列} col\r\n     * @param  {存放该节点以上的所有节点数组} arr\r\n     */\r\n    upFindNodes : function(row,col,arr){\r\n        if(arguments.length === 2){\r\n            var tempArr = [];\r\n        }\r\n        while(row > 0){\r\n            row--;\r\n            var upNode = this.backGroundArr[row][col].getComponent(\"Back\").innerNode;\r\n            if(upNode != null){\r\n                if(upNode.getComponent(\"Figure\").isRemove === true){\r\n                    continue;\r\n                }else{\r\n                    if(arguments.length === 3){\r\n                        //将不是待消节点添加到数组中去\r\n                        if(!arr.contain(upNode)){    \r\n                            //如果该数组中还没有该节点的话就加进去\r\n                            arr.push(upNode);\r\n                        }\r\n                    }else{\r\n                        if(!tempArr.contain(upNode))\r\n                            tempArr.push(upNode);\r\n                    }\r\n                }\r\n            }else{\r\n                //如果upNode是空的话\r\n                break;\r\n            }\r\n        }\r\n        if(arguments.length === 2){\r\n            return tempArr;\r\n        }\r\n    },\r\n   //\r\n   /**\r\n    * 递归查找该节点上下左右四个方向是否有跟自己的类型相同的节点\r\n    * @param  {待检测节点} node\r\n    * @param  {待检测节点所在的行} row\r\n    * @param  {待检测节点所在的列} col\r\n    * @param  {待检测节点的类型} type\r\n    * @param  {待消除队列} arr\r\n    */\r\n   find : function(node,row,col,type,arr){\r\n       //定义上下左右四个方向数组\r\n       var round = [[row-1,col],[row+1,col],[row,col-1],[row,col+1]];\r\n       if(!arr.contain(node)){\r\n           //如果当前数组中不包含该节点就加入数组\r\n           arr.push(node);\r\n       }\r\n       for(let i =0;i < round.length;i++){\r\n           //如果计算的行或者列超出了边界继续下一个行列\r\n           if(round[i][0] < 0 || round[i][0] >11 || round[i][1] > 5 || round[i][1] < 0){\r\n               continue;\r\n           }\r\n           var checkType = this.backGroundArr[round[i][0]][round[i][1]].getComponent(\"Back\").type;\r\n           if(checkType === type && checkType < 4 && checkType >= 0){\r\n                var waitDeleteNode = this.backGroundArr[round[i][0]][round[i][1]].getComponent(\"Back\").innerNode;\r\n                if(!arr.contain(waitDeleteNode)){\r\n                    arr.push(waitDeleteNode);\r\n                    //递归寻找节点\r\n                    this.find(waitDeleteNode,round[i][0],round[i][1],type,arr);\r\n                }\r\n           }\r\n       }\r\n   },\r\n   //方块下落方法\r\n   down : function(nodeArr){\r\n        //在update里面发送下落数据标记\r\n        this.sendDown = true;\r\n        this.jsonMsgToServer.score = this.score;\r\n        //获得最小行\r\n        var minRow = Math.min.apply(Math,Array.of(nodeArr[0].getComponent(\"Figure\").row,nodeArr[1].getComponent(\"Figure\").row));\r\n        var colArr = []; //= Array.of(nodeArr[0].getComponent(\"Figure\").col,nodeArr[1].getComponent(\"Figure\").col);\r\n        for(let m = 0;m<2;m++){\r\n            let colNum = nodeArr[m].getComponent(\"Figure\").col;\r\n            //数组去重\r\n            if(!colArr.includes(colNum)){\r\n                colArr.push(colNum)\r\n            }\r\n        }\r\n        //位移2个方格\r\n        for(var i = nodeArr.length-1;i >= 0;i--){\r\n            var row = this.getRow(nodeArr[i]);\r\n            var col = this.getColumn(nodeArr[i]);\r\n            nodeArr[i].y = this.backGroundArr[row+1][col].y;\r\n            //改变该节点的行数\r\n            nodeArr[i].getComponent(\"Figure\").row = row+1;\r\n            var afterDownRow = nodeArr[i].getComponent(\"Figure\").row;\r\n            //将这些行的信息存到json数组里发送给服务器\r\n            let currentJson = {};\r\n            currentJson.row = afterDownRow;\r\n            currentJson.col = col;\r\n            currentJson.color = nodeArr[i].getComponent(\"Figure\").type.toString();\r\n            this.jsonMsgToServer.changeMapList1.push(currentJson);\r\n            if(afterDownRow-1 === minRow){\r\n                //如果是同行不同列的情况的话遍历各个列\r\n                for(let j = 0;j<colArr.length;j++){\r\n                    var upZero = {};\r\n                    upZero.row = minRow;\r\n                    upZero.col = colArr[j];\r\n                    upZero.color = \"-1\";\r\n                    this.jsonMsgToServer.changeMapList1.push(upZero);\r\n                }\r\n            }\r\n        }\r\n        console.log(\"jsonMstToLServer is \" + this.jsonMsgToServer);\r\n        console.log(\"tag1 is \" + this.jsonMsgToServer.tag1);\r\n        console.log(\"score is \" + this.jsonMsgToServer.score);\r\n        console.log(\"changeMapList1 is \" + this.jsonMsgToServer.changeMapList1.length);\r\n        console.log(\"=================下落发送数据到服务器开始==================\");\r\n        \r\n    },\r\n    //将这两个预制体的坐标数值保留两位小数\r\n    remainTwoNumber : function(nodeArr){\r\n        for(let k = 0;k<nodeArr.length;k++){\r\n            //将所有的坐标变成只保留两位小数的数字\r\n            nodeArr[k].x = Number(nodeArr[k].x.toFixed(2));\r\n            nodeArr[k].y = Number(nodeArr[k].y.toFixed(2));\r\n        }\r\n    },\r\n    //旋转方法\r\n    rotate : function(){\r\n        if(!this.gameOver){\r\n            //记录下旋转的位置\r\n            // this.unscheduleAllCallbacks();\r\n            if(this.isCreateOver){\r\n                this.playAudio(this.clickAudio);\r\n                this.rotateButton.children[0].opacity = 120;\r\n                var self = this;\r\n                //旋转中心\r\n                var x0 = this.nodeArr[1].x;\r\n                var y0 = this.nodeArr[1].y;\r\n                var x0Row = this.getRow(this.nodeArr[1]);\r\n                var x0Col = this.getColumn(this.nodeArr[1]);\r\n        \r\n                // var rotateArr = [[x0Row-1,x0Col],[x0Row,x0Col+1],[x0Row+1,x0Col],[x0Row,x0Col-1 ]];\r\n                //旋转0度对应的坐标\r\n                var x = this.nodeArr[0].x;\r\n                var y = this.nodeArr[0].y;\r\n                \r\n                //旋转45度对应的坐标\r\n                var rotate45X = (x-x0)*Math.cos(-Math.PI/4)-(y-y0)*Math.sin(-Math.PI/4) + x0;\r\n                var rotate45Y = (x-x0)*Math.sin(-Math.PI/4)+(y-y0)*Math.cos(-Math.PI/4) + y0;\r\n                //节点的旋转状态\r\n                var nodeAngle = this.nodeArr[0].getComponent(\"Figure\").angle;\r\n                var canAction = false;\r\n                if(nodeAngle === 0){\r\n                    //边界旋转\r\n                    if(x0Col === 5){\r\n                        //改变旋转中心进行旋转内部进行判断是否可以旋转\r\n                        this.changeRotateCenter(nodeAngle,x0Col);\r\n                    }else{\r\n                        if(this.checkIsRotate(x0Row,x0Col,nodeAngle)){\r\n                            //旋转90度对应的坐标位置\r\n                            var bezier = this.dealRotate(nodeAngle,x0Row,x0Col,rotate45X,rotate45Y,x,y,1);\r\n                            //能够旋转\r\n                            canAction = true;\r\n                        }\r\n                    }\r\n                    \r\n                }else if(nodeAngle === 1){\r\n                    if(this.checkIsRotate(x0Row,x0Col,nodeAngle)){\r\n                        var bezier = this.dealRotate(nodeAngle,x0Row,x0Col,rotate45X,rotate45Y,x,y,2);\r\n                        canAction = true;\r\n                    }\r\n                }else if(nodeAngle === 2){\r\n                    //边界旋转判断改为顺时针旋转（以#0块为旋转中心）\r\n                    if(x0Col === 0){\r\n                    this.changeRotateCenter(nodeAngle,x0Col);\r\n                    }else{\r\n                        if(this.checkIsRotate(x0Row,x0Col,nodeAngle)){\r\n                            var bezier = this.dealRotate(nodeAngle,x0Row,x0Col,rotate45X,rotate45Y,x,y,3);\r\n                            canAction = true;\r\n                        }\r\n                    }\r\n                }else if(nodeAngle === 3){\r\n                    if(this.checkIsRotate(x0Row,x0Col,nodeAngle)){\r\n                        //创建贝塞尔曲线所对应的最少坐标\r\n                        var bezier = this.dealRotate(nodeAngle,x0Row,x0Col,rotate45X,rotate45Y,x,y,0);\r\n                        canAction = true;\r\n                    }\r\n                }\r\n                if(canAction){\r\n                    (function test(cb){\r\n                        var bezierAction = cc.bezierTo(0.008,bezier);\r\n                        self.nodeArr[0].runAction(bezierAction);\r\n                        cb()\r\n                    })(pro);\r\n                    function pro() {\r\n                        cc.log(\"承诺正常执行########\");\r\n                        cc.log(\"@@@@@@@@@@\" + self.nodeArr[0].x);\r\n                        cc.log(\"@@@@@@@@@@\" + self.nodeArr[0].y);\r\n                    }\r\n                    cc.log(\"结束旋转动作!!!!!\");\r\n                }\r\n            }\r\n            this.scheduleOnce(function(){\r\n                this.rotateButton.children[0].opacity = 0;\r\n            },0.5);\r\n        }\r\n    },\r\n    //处理旋转\r\n    /**\r\n     * @param  {当前需要旋转的节点的角度代码属性} angle\r\n     * @param  {旋转中心所在的行} row\r\n     * @param  {选装中心所在的列} col\r\n     * @param  {旋转45度对应的x坐标} rotate45X\r\n     * @param  {旋转45度对应的y坐标} rotate45Y\r\n     * @param  {旋转之前的x坐标} x\r\n     * @param  {旋转之前对应的y坐标} y\r\n     * @param  {旋转之后该节点对应的角度属性代号} angleCode\r\n     */\r\n    dealRotate : function(angle,row,col,rotate45X,rotate45Y,x,y,angleCode){\r\n        var nodeZeroType = this.nodeArr[0].getComponent(\"Figure\").type.toString();\r\n        var nodeOneType = this.nodeArr[1].getComponent(\"Figure\").type.toString();\r\n        var json1,json2,json3;\r\n        if(angle === 0){\r\n            var rotate90X = this.backGroundArr[row][col+1].x;\r\n            var rotate90Y = this.backGroundArr[row][col+1].y;\r\n            this.nodeArr[0].getComponent(\"Figure\").row = row;\r\n            this.nodeArr[0].getComponent(\"Figure\").col = col+1;\r\n            console.log(\"$$$$$$$$$$$$$$$$$$$$$\");\r\n            //发送json对象到服务器\r\n            json1 = this.createJsonDateForServer(row-1,col,\"-1\");\r\n            json2 = this.createJsonDateForServer(row,col,nodeOneType);\r\n            json3 = this.createJsonDateForServer(row,col+1,nodeZeroType);\r\n            \r\n        }else if(angle === 1){\r\n            var rotate90X = this.backGroundArr[row+1][col].x;\r\n            var rotate90Y = this.backGroundArr[row+1][col].y;  \r\n            this.nodeArr[0].getComponent(\"Figure\").row = row+1;\r\n            this.nodeArr[0].getComponent(\"Figure\").col = col;  \r\n            console.log(\"$$$$$$$$$$$$$$$$$$$$\");\r\n            json1 = this.createJsonDateForServer(row,col+1,\"-1\");\r\n            json2 = this.createJsonDateForServer(row,col,nodeOneType);\r\n            json3 = this.createJsonDateForServer(row+1,col,nodeZeroType);\r\n        }else if(angle === 2){\r\n            var rotate90X = this.backGroundArr[row][col-1].x;\r\n            var rotate90Y = this.backGroundArr[row][col-1].y;\r\n            this.nodeArr[0].getComponent(\"Figure\").row = row;\r\n            this.nodeArr[0].getComponent(\"Figure\").col = col-1;\r\n            json1 = this.createJsonDateForServer(row+1,col,\"-1\");\r\n            json2 = this.createJsonDateForServer(row,col,nodeOneType);\r\n            json3 = this.createJsonDateForServer(row,col-1,nodeZeroType);    \r\n        }else if(angle === 3){\r\n            var rotate90X = this.backGroundArr[row-1][col].x;\r\n            var rotate90Y = this.backGroundArr[row-1][col].y;\r\n            this.nodeArr[0].getComponent(\"Figure\").row = row-1;\r\n            this.nodeArr[0].getComponent(\"Figure\").col = col;\r\n            json1 = this.createJsonDateForServer(row,col-1,\"-1\");\r\n            json2 = this.createJsonDateForServer(row,col,nodeOneType);\r\n            json3 = this.createJsonDateForServer(row-1,col,nodeZeroType);    \r\n        }\r\n        try{\r\n            this.sendRotate = true;\r\n            console.log(\"*************进入try语句块****************\");\r\n            let jsonArr = Array.of(json1,json2,json3);\r\n            this.pushChangeMapList(jsonArr);\r\n        }catch(e){\r\n            console.log(e);\r\n        }\r\n        \r\n        //创建贝塞尔曲线所对应的最少坐标\r\n        var bezier = [cc.p(x,y),cc.p(rotate45X,rotate45Y),cc.p(rotate90X,rotate90Y)];\r\n        // //初始向量\r\n        // var startV = cc.v2(x,y).sub(cc.v2(x0,y0));\r\n        // var result = startV.rotate(Math.PI/2);\r\n        this.nodeArr[0].x = rotate90X;\r\n        this.nodeArr[0].y = rotate90Y;\r\n        //旋转之后变成相应的角度\r\n        this.nodeArr[0].getComponent(\"Figure\").angle = angleCode;\r\n        return bezier;\r\n    },\r\n    //创建一个json数组\r\n    pushChangeMapList : function(jsonArr){\r\n        for(let i = 0;i < jsonArr.length;i++){\r\n            this.jsonMsgToServer.changeMapList1.push(jsonArr[i]);\r\n        }\r\n    },\r\n    //创建发送给服务器的json数据\r\n    /**\r\n     * @param  {发送给服务器的行} row\r\n     * @param  {发送给服务器的列} col\r\n     * @param  {发送给服务器的类型} color\r\n     */\r\n    createJsonDateForServer : function(row,col,color){\r\n        let jsonData = {\r\n            row : row,\r\n            col : col,\r\n            color : color,\r\n        }\r\n        return jsonData;\r\n    },\r\n    //发送数据到服务器\r\n    sendDataToServer : function(jsonMsg){\r\n        //发送json数据到服务器\r\n        cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(jsonMsg);\r\n    },\r\n    //变换旋转中心\r\n    changeRotateCenter : function(nodeAngle,col){\r\n        var canRotate = false;\r\n        var self = this;\r\n        var x00 = this.nodeArr[0].x;\r\n        var y00 = this.nodeArr[0].y;\r\n        var x00Row = this.getRow(this.nodeArr[0]);\r\n        var x00Col = this.getColumn(this.nodeArr[0]);\r\n\r\n        var xx = this.nodeArr[1].x;\r\n        var yy = this.nodeArr[1].y;\r\n\r\n        //旋转45度方向\r\n        var rotate45Xc = (xx-x00)*Math.cos(-Math.PI/4)-(yy-y00)*Math.sin(-Math.PI/4) + x00;\r\n        var rotate45Yc = (xx-x00)*Math.sin(-Math.PI/4)+(yy-y00)*Math.cos(-Math.PI/4) + y00;\r\n        if(nodeAngle === 0 && col === 5){\r\n            //检查是否可以旋转\r\n            var json1,json2,json3;\r\n            var nodeZeroType = this.nodeArr[0].getComponent(\"Figure\").type;\r\n            var nodeOneType = this.nodeArr[1].getComponent(\"Figure\").type;\r\n            if(this.checkIsRotateByRotateCenter(x00Row,x00Col,nodeAngle)){\r\n                var rotate90X = this.backGroundArr[x00Row][x00Col-1].x;\r\n                var rotate90Y = this.backGroundArr[x00Row][x00Col-1].y;\r\n                this.nodeArr[1].getComponent(\"Figure\").row = x00Row;\r\n                this.nodeArr[1].getComponent(\"Figure\").col = x00Col-1;   \r\n\r\n                //发送数据到服务器\r\n                json1 = this.createJsonDateForServer(x00Row + 1,x00Col,\"-1\");\r\n                json2 = this.createJsonDateForServer(x00Row,x00Col,nodeZeroType);\r\n                json3 = this.createJsonDateForServer(x00Row,x00Col-1,nodeOneType);\r\n                \r\n                canRotate = true;\r\n            }\r\n           \r\n        }else if(nodeAngle === 2 && col === 0){\r\n            if(this.checkIsRotateByRotateCenter(x00Row,x00Col,nodeAngle)){\r\n                var rotate90X = this.backGroundArr[x00Row][x00Col+1].x;\r\n                var rotate90Y = this.backGroundArr[x00Row][x00Col+1].y;   \r\n                this.nodeArr[1].getComponent(\"Figure\").row = x00Row;\r\n                this.nodeArr[1].getComponent(\"Figure\").col = x00Col+1;   \r\n                //发送数据到服务器\r\n                json1 = this.createJsonDateForServer(x00Row - 1,x00Col,\"-1\");\r\n                json2 = this.createJsonDateForServer(x00Row,x00Col,nodeZeroType);\r\n                json3 = this.createJsonDateForServer(x00Row,x00Col+1,nodeOneType);\r\n                canRotate = true;\r\n            }\r\n            \r\n        }\r\n        //如果能旋转的话就进行执行贝塞尔曲线\r\n        if(canRotate){\r\n            try{\r\n                this.sendRotate = true;\r\n                let jsonArr = Array.of(json1,json2,json3);\r\n                this.pushChangeMapList(jsonArr);\r\n            }catch(e){\r\n                console.log(e);\r\n            }\r\n            //创建贝塞尔曲线所对应的最少坐标\r\n            var bezier = [cc.p(xx,yy),cc.p(rotate45Xc,rotate45Yc),cc.p(rotate90X,rotate90Y)];\r\n            // //初始向量\r\n            this.nodeArr[1].x = rotate90X;\r\n            this.nodeArr[1].y = rotate90Y;\r\n            //旋转之后变成270度\r\n            if(nodeAngle === 2 && col === 0){\r\n                this.nodeArr[0].getComponent(\"Figure\").angle = 3;\r\n            }else if(nodeAngle === 0 && col === 5){\r\n                this.nodeArr[0].getComponent(\"Figure\").angle = 1;\r\n            }\r\n            //执行贝塞尔曲线动作\r\n            (function test(cb){\r\n                \r\n                var bezierAction = cc.bezierTo(0.008,bezier);\r\n                self.nodeArr[1].runAction(bezierAction);\r\n                cb()\r\n            })(pro.bind(self));\r\n            function pro() {\r\n                cc.log(\"承诺正常执行########\");\r\n                cc.log(\"@@@@@@@@@@\" + self.nodeArr[0].x);\r\n                cc.log(\"@@@@@@@@@@\" + self.nodeArr[0].y);\r\n            }\r\n            \r\n        }\r\n    },\r\n    /**\r\n     * 检查以0号数组元素为旋转中心检查是否可以旋转\r\n     * @param  {以零号数组节点所在的行} centerRow\r\n     * @param  {以零号数组节点所在的列} centerCol\r\n     * @param  {以零号数组节点所在的角度} angle\r\n     */\r\n    checkIsRotateByRotateCenter : function(centerRow,centerCol,angle){\r\n        if(angle === 2 && centerCol === 0){\r\n            if(this.map[centerRow-1][centerCol+1] != 1 && this.map[centerRow][centerCol+1] != 1){\r\n                return true;\r\n            }else{\r\n                return false;\r\n            }\r\n        }else if(angle === 0 && centerCol === 5){\r\n            if(this.map[centerRow+1][centerCol-1] != 1 && this.map[centerRow][centerCol-1] != 1){\r\n                return true;\r\n            }else{\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n    //检查是否可以旋转\r\n    /**\r\n     * @param  {旋转中心节点所在的行} centerRow\r\n     * @param  {旋转中心节点所在的列} centerCol\r\n     * @param  {待旋转节点的角度属性} angle\r\n     */\r\n    checkIsRotate : function(centerRow,centerCol,angle){\r\n            //四个方向\r\n            //如果当前方向是0的话就看看一方向对应的背景方格的状态是什么\r\n            if(angle === 0){\r\n                //检查旋转中心节点的右边背景方格的状态是否为1和检查#0块右边对应的背景方格是否为1\r\n                if(this.map[centerRow-1][centerCol+1] != 1 && this.map[centerRow][centerCol+1] != 1){\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }else if(angle === 1){\r\n                if(this.map[centerRow+1][centerCol+1] != 1 && this.map[centerRow+1][centerCol] != 1){\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }else if(angle === 2){\r\n                if(this.map[centerRow+1][centerCol-1] != 1 && this.map[centerRow][centerCol-1] != 1){\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }else if(angle === 3){\r\n                if(this.map[centerRow-1][centerCol-1] != 1 && this.map[centerRow-1][centerCol] != 1){\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }\r\n    },\r\n     //左移方法\r\n    moveLeft    : function(){\r\n        if(!this.gameOver){\r\n            this.remainTwoNumber(this.nodeArr);\r\n            if(this.CheckIsLeft()){\r\n                //打开发送向左移动的开关\r\n                this.sendLeft = true;\r\n                //获得最大列\r\n                var maxCol = Math.max.call(null,this.nodeArr[0].getComponent(\"Figure\").col,this.nodeArr[1].getComponent(\"Figure\").col);\r\n                var rowArr = [this.nodeArr[0].getComponent(\"Figure\").row,this.nodeArr[1].getComponent(\"Figure\").row];\r\n                \r\n                for(let i = 0;i < this.nodeArr.length;i++){\r\n                    this.leftMove(this.nodeArr[i]);\r\n                }\r\n                //如果生成方块的个数是一个的话加发送两个数据给服务器就行了\r\n                for(let j = 0;j < rowArr.length;j++){\r\n                    var jsonDataToServer = {\r\n                        row   : rowArr[j],\r\n                        col   : maxCol,\r\n                        color : \"-1\",\r\n                    }\r\n                    //将该信息添加到json对象中去发送到服务器并且进行去重\r\n                    console.log(\"是否包含该对象：\",this.jsonMsgToServer.changeMapList1.isContain(jsonDataToServer));\r\n                    if(!this.jsonMsgToServer.changeMapList1.isContain(jsonDataToServer)){\r\n                        this.jsonMsgToServer.changeMapList1.push(jsonDataToServer);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    leftMove : function(node){\r\n        var row = node.getComponent(\"Figure\").row;\r\n        var col = node.getComponent(\"Figure\").col;\r\n        //将当前背景节点的node改为null\r\n        // this.backGroundArr[row][col].node = null;\r\n        node.x = this.backGroundArr[row][col-1].x;\r\n        node.getComponent(\"Figure\").row = row;\r\n        node.getComponent(\"Figure\").col = col-1;\r\n        let afterLeftJson = {\r\n            row : row,\r\n            col : col - 1,\r\n            color : node.getComponent(\"Figure\").type.toString(),\r\n        }\r\n        if(!this.jsonMsgToServer.changeMapList1.isContain(afterLeftJson)){\r\n            this.jsonMsgToServer.changeMapList1.push(afterLeftJson);\r\n        }\r\n    },\r\n   //右移方法\r\n   moveRight   : function(){\r\n       if(!this.gameOver){\r\n           this.remainTwoNumber(this.nodeArr);\r\n           //获得最小列\r\n           var minCol = Math.min.call(null,this.nodeArr[0].getComponent(\"Figure\").col,this.nodeArr[1].getComponent(\"Figure\").col);\r\n           var rowArr = [this.nodeArr[0].getComponent(\"Figure\").row,this.nodeArr[1].getComponent(\"Figure\").row];\r\n           if(this.CheckIsRight()){\r\n               this.sendRight = true;\r\n               for(var i = 0;i < this.nodeArr.length;i++){\r\n                   this.rightMove(this.nodeArr[i]);\r\n                }\r\n            } \r\n            for(let i = 0;i < rowArr.length;i++){\r\n                var jsonDataToServer = {\r\n                    row   : rowArr[i],\r\n                    col   : minCol,\r\n                    color : \"-1\",\r\n                }\r\n                //将该信息添加到json对象中去发送到服务器\r\n                if(!this.jsonMsgToServer.changeMapList1.isContain(jsonDataToServer)){\r\n                    this.jsonMsgToServer.changeMapList1.push(jsonDataToServer);\r\n                }\r\n            }\r\n            console.log(\"================发送数据开始================\");\r\n            \r\n        }\r\n    },\r\n    rightMove : function(node){\r\n        var row = node.getComponent(\"Figure\").row;\r\n        var col = node.getComponent(\"Figure\").col;\r\n        //将当前背景节点的node改为null\r\n        node.x = this.backGroundArr[row][col+1].x;\r\n        node.getComponent(\"Figure\").row = row;\r\n        node.getComponent(\"Figure\").col = col+1;\r\n        let afterRightJson = {\r\n            row : row,\r\n            col : col + 1,\r\n            color : node.getComponent(\"Figure\").type.toString(),\r\n        }\r\n        if(!this.jsonMsgToServer.changeMapList1.isContain(afterRightJson)){\r\n            this.jsonMsgToServer.changeMapList1.push(afterRightJson);\r\n        }\r\n    },\r\n    /**\r\n        检测是否可以向下移动\r\n        返回true或者false\r\n        @return true  : 可以下落\r\n        @return false : 不可以下落\r\n    **/\r\n    /**\r\n     * @param  {待检测的节点数组} nodeArr\r\n     */\r\n    CheckIsDown : function(nodeArr){\r\n        if(nodeArr.length != 0){\r\n            //将坐标值转换为小数点两位小数\r\n            this.remainTwoNumber(nodeArr);\r\n            //如果#0块的属性angle为零的时候，只判断#1块下面是否为1，为1不下落，为地面不下落\r\n            if(nodeArr[0].getComponent(\"Figure\").angle === 0){\r\n                return this.checkIsBottom(nodeArr[1],0);\r\n            }else if(nodeArr[0].getComponent(\"Figure\").angle === 1 || nodeArr[0].getComponent(\"Figure\").angle === 3){\r\n                //横条的形状的时候会出现有一个下落的情况\r\n                if(this.checkDown(nodeArr) && !(this.checkDown(nodeArr) instanceof cc.Node)){\r\n                    return true;\r\n                }else if(!this.checkDown(nodeArr) && !(this.checkDown(nodeArr) instanceof cc.Node)){\r\n                    return false;\r\n                }else if(this.checkDown(nodeArr) instanceof cc.Node){\r\n                    var targetNode = this.checkDown(nodeArr);\r\n                    //找出这个下面背景方格状态为0的节点\r\n                    var targetRow = this.findTheNodeDown(targetNode);\r\n                    var col = this.getColumn(targetNode);\r\n                    //单独下落这个节点\r\n                    targetNode.getComponent(\"Figure\").quickDown(targetRow,col,this.backGroundArr,this.map,true);\r\n                    return false;\r\n                }\r\n            }else if(nodeArr[0].getComponent(\"Figure\").angle === 2){\r\n                return this.checkIsBottom(nodeArr[0],2);\r\n            }\r\n        }\r\n    },\r\n    \r\n    /**\r\n     * @param  {需要向下搜索背景方格的状态的初始节点} node\r\n     */\r\n    findTheNodeDown : function(node){\r\n         //获得当前节点的行和列\r\n         var row = this.getRow(node);\r\n         var col = this.getColumn(node);\r\n         //向下寻找\r\n         while(row < 11){\r\n            row++;\r\n            if(this.map[row][col] === 1){\r\n                break;\r\n            }\r\n            if(row === 11){\r\n                break;\r\n            }\r\n         }\r\n         //最底下的背景方格的状态不为1\r\n         if(row === 11 && this.map[row][col] != 1){\r\n             return 11;\r\n         }else{\r\n            return row-1;\r\n         }\r\n         \r\n    },\r\n    //判断横条的情况\r\n    checkDown : function(nodeArr){\r\n        this.remainTwoNumber(nodeArr);\r\n        var count1 = 0;\r\n        var count0 = 0;\r\n        var nodeDownIsZero = [];\r\n        //如果是第11行就放回false\r\n        if(this.getRow(nodeArr[0]) === 11){\r\n            return false;\r\n        }\r\n        for(let m = 0;m < nodeArr.length;m++){\r\n            var row = this.getRow(nodeArr[m]);\r\n            var col = this.getColumn(nodeArr[m]);\r\n            if(this.map[row+1][col] === 1){\r\n                count1++;\r\n            }else if(this.map[row+1][col] ===0){\r\n                count0++;\r\n                nodeDownIsZero.push(nodeArr[m]);\r\n            }\r\n        }\r\n        if(count1 === 2){\r\n            //如果两个块的下面都为1的话不可以下落\r\n            return false;\r\n        }else if(count0 === 2){\r\n            //如果两个块的下面都为0的话是可以下落的\r\n            return true;\r\n        }else{\r\n            if(nodeDownIsZero.length > 0 && nodeDownIsZero.length === 1){\r\n                return nodeDownIsZero[0];\r\n            }\r\n        }\r\n        \r\n\r\n    },\r\n    // },\r\n    //判断是否触底或者是下面还有方块\r\n    /**\r\n     * @param  {待检测的节点} node\r\n     */\r\n    checkIsBottom : function(node,angle){\r\n        // if(angle === 0 || angle === 2){\r\n            var row = this.getRow(node);\r\n            var col = this.getColumn(node);\r\n            if(row != 11){\r\n                //下一行背景方格的状态是否为1\r\n                if(this.map[row + 1][col] === 1){\r\n                    //将对应的背景方格的状态改为1\r\n                    return false;\r\n                }else{\r\n                    return true;\r\n                }\r\n            }else{\r\n                return false;\r\n            }\r\n    },\r\n    /**\r\n       检测是否可以向左移动\r\n    **/\r\n   CheckIsLeft : function(){\r\n        //如果两个形状还没有完全落下来不能左移右移\r\n        if(this.nodeArr[0].y > this.nodeHeight/2){\r\n                return false;\r\n        }\r\n        this.remainTwoNumber(this.nodeArr);\r\n        var colArr = [this.nodeArr[0].getComponent(\"Figure\").col,this.nodeArr[1].getComponent(\"Figure\").col];\r\n        var rowArr = [];\r\n        for(let i = 0;i< this.nodeArr.length;i++){\r\n            rowArr.push(this.getRow(this.nodeArr[i]));\r\n        }\r\n        //找到最小列\r\n        var col = Math.min.apply(null,colArr);\r\n        if(colArr.length > 0){\r\n            //同一列\r\n            if(colArr[0] === colArr[colArr.length-1]){\r\n                if(col === 0){\r\n                    return false;\r\n                }\r\n                //说明是同一列\r\n                //找出x坐标最小的左边看看它的坐标地图状态值是多少\r\n                if(this.map[rowArr[0]][col-1] === 0 && this.map[rowArr[1]][col-1] === 0){\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }else{\r\n                //同一行\r\n                if(this.map[rowArr[0]][col-1] === 0){\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //检测是否可以向右移动\r\n    CheckIsRight : function(){\r\n          //如果两个形状还没有完全落下来不能左移右移\r\n        if(this.nodeArr[0].y > this.nodeHeight/2){\r\n            return false;\r\n        }\r\n        var rowArr = [];\r\n        var colArr = [this.nodeArr[0].getComponent(\"Figure\").col,this.nodeArr[1].getComponent(\"Figure\").col];\r\n        this.remainTwoNumber(this.nodeArr);\r\n        for(let i = 0;i< this.nodeArr.length;i++){\r\n            rowArr.push(this.getRow(this.nodeArr[i]));\r\n        }\r\n        //找到最大列\r\n        var col = Math.max.apply(null,colArr);\r\n        if(colArr.length > 0){\r\n            //同一列\r\n            if(colArr[0] === colArr[colArr.length-1]){\r\n                if(col === 5){\r\n                    return false;\r\n                }\r\n                //说明是同一列\r\n                //找出x坐标最小的左边看看它的坐标地图状态值是多少\r\n                if(this.map[rowArr[0]][col+1] === 0 && this.map[rowArr[1]][col+1] === 0){\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }else{\r\n            //同一行\r\n            if(this.map[rowArr[0]][col+1] === 0){\r\n                //如果最大行右边的背景方格的状态是0的话就可以移动\r\n                return true;\r\n            }else{\r\n                return false;\r\n            }\r\n\r\n            }\r\n        }\r\n    },\r\n    //暂停游戏\r\n    // pause : function(){\r\n    //     console.log(\"游戏结束了吗草\",this.gameOver);\r\n    //     if(!this.gameOver){\r\n    //         //暂停游戏\r\n    //         console.log(\"点击了网络版的暂停\");\r\n    //         this.mask.active = true;\r\n    //         this.pauseMenu.active = true;\r\n    //     }\r\n    // },\r\n    //网络版游戏的惩罚机制\r\n    /**\r\n     * @param  {Array | 惩罚地图二维数组} punishArr\r\n     */\r\n    wasPunishedByRival : function(punishArr){\r\n        this.isPunish = true;\r\n        console.log(\"punishArr is \" + punishArr.toString());\r\n        if(punishArr instanceof Array){\r\n            console.log(\"punishArr's length is\" + punishArr.length);\r\n            //分别对需要涨的数据进行处理\r\n            for(let i = 0;i < punishArr.length;i++){\r\n                  //该数组中的json数据长度\r\n                  var jsonNumber = punishArr[i].length;\r\n                  if(punishArr[i][0] instanceof Object){\r\n                        //确定哪一列需要涨\r\n                        var punishCol = punishArr[i][0].col;\r\n                        //确定需要涨的类型\r\n                        var punishType = punishArr[i][0].color;\r\n                        //生成惩罚块并将惩罚块下落状态修改并发送到服务器\r\n                        this.generatePunishBlock(punishCol,Number(punishType),jsonNumber);\r\n                  }else{\r\n                      console.log(\"punishArr is not an Object of js \");\r\n                  }\r\n            }\r\n        }\r\n    },\r\n    //生成惩罚小方块\r\n    /**\r\n     * @param  {生成惩罚所在的列} col\r\n     * @param  {生成惩罚那些块的类型} type\r\n     * @param  {生成惩罚的个数} count\r\n     */\r\n    generatePunishBlock : function(col,type,count){\r\n        var generatePunishJson = {\r\n            col           : col,\r\n            generateCount : count,\r\n            punishType    : type,\r\n        }\r\n        //生成惩罚方块\r\n        var punishBlockArr = this.initImage(this.node,generatePunishJson);\r\n        //遍历惩罚方块数组分别下落惩罚方块\r\n        for(let i = 0;i < punishBlockArr.length;i++){\r\n            //让生成的方块显示\r\n            punishBlockArr[i].active = true;\r\n            //下落惩罚方块是网络版的状况它会自己发送数据到服务器\r\n            punishBlockArr[i].getComponent(\"Figure\").afterRemoveDown(this.map,this.backGroundArr,true);\r\n        }\r\n        \r\n    },\r\n    //为俄罗斯方块或者噗哟噗哟计算分数\r\n    /**\r\n     * @param  {消行数} removeRows\r\n     * @param  {显示分数的节点} node\r\n     */\r\n    showScoreForGame1 : function(removeRows,node){\r\n        switch (removeRows) {\r\n            case 1:\r\n                node.getComponent(cc.Label).string = (parseInt(node.getComponent(cc.Label).string) + 40).toString();\r\n                break;\r\n            case 2:\r\n                node.getComponent(cc.Label).string = (parseInt(node.getComponent(cc.Label).string) + 90).toString();\r\n                break;\r\n            case 3:\r\n                node.getComponent(cc.Label).string = (parseInt(node.getComponent(cc.Label).string) + 150).toString();\r\n                break;\r\n            case 4:\r\n                node.getComponent(cc.Label).string = (parseInt(node.getComponent(cc.Label).string) + 220).toString();\r\n                break;\r\n        }\r\n    },\r\n    //游戏结束在来一局\r\n    overAgain : function(){\r\n        if(cc.sys.isNative){\r\n            cc.director.resume();\r\n        }\r\n        console.log(\"游戏结束点击了再来一局\");\r\n        this.mask.active = false;\r\n        // this.pauseMenu.active = false;\r\n        cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg({\"tag1\":1,\"type\":\"4\",\"score\":\"\",\"nMapRow\":\"\",\"nMapCol\":\"\"});\r\n        //匹配用户界面\r\n        console.log(\"游戏进入匹配界面\");\r\n        //场景切换的时候资源释放了会将vs界面给回收那么\r\n        // var runScene = cc.director.getScene();\r\n        // var uid = runScene.uuid;\r\n        // var assetsArr = cc.loader.getDependsRecursively(uid);\r\n        // console.log(\"资源数组是：\",assetsArr);\r\n        // //释放资源数组\r\n        // cc.loader.release(assetsArr);\r\n        cc.director.loadScene(\"MatchUser\");\r\n        // cc.director.pause();\r\n    },\r\n    //游戏结束暂时退出\r\n    overQuit : function(){\r\n        if(cc.sys.isNative){\r\n            cc.director.resume();\r\n        }\r\n        console.log(\"暂时退出尼玛就那么难擦\");\r\n        //加载多人选择模式\r\n        cc.director.loadScene(\"PersonsChoose\");\r\n        //资源释放了的话vs多人选择界面有可能会被回收那么加载vs图片的时候就会报GL错误\r\n        // cc.director.pause();\r\n    },\r\n    //游戏结束分享功能\r\n    overShare : function(){\r\n        if(CC_WECHATGAME){\r\n            console.log(\"首页share\");\r\n            cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").shareFriends();\r\n        }else if(cc.sys.isNative){\r\n            cc.director.resume();\r\n            //原生平台分享\r\n            cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").nativeShare();\r\n        }\r\n    },\r\n    //播放音乐方法\r\n    playAudio : function(audioUrl){\r\n        cc.audioEngine.play(audioUrl,false,1);\r\n    },\r\n});\r\n"]}