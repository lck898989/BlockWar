{"version":3,"sources":["FightGame3.js"],"names":["Game3","require","cc","Class","extends","Component","properties","prefabArr","default","type","Prefab","girdSize","backPrefab","scoreLabel","Node","nextShape","rivalInfoNode","downButton","slideButton","rotateButton","mask","pauseMenu","overMenu","overAnimation","gameSlide","nickName","rivalName","onLoad","normalSpeed","quickSpeed","up","lr","log","director","isPaused","resume","active","jsonMsgToServer","tag1","score","state1","changeMapList1","removeMapList1","nMapRow","nMapCol","loading1","nodeWidth","node","width","nodeHeight","height","eliminateCount","backGroundArr","time","initMap","nodeArr","createShape","createNext","gameOver","canChangeStatu","iState","xltime","cishu","Array","prototype","contain","shape","undefined","i","length","x","y","getComponent","on","children","opacity","bind","registerKeyBoard","removeTime","overCost","index","sys","isNative","Label","string","find","nameUser","SendLongMsg","nUserScore","nCol","rightDirection","leftDirection","slideStart","rivalTouchBarry","invokeRemoveTime","sendLeft","sendRight","sendDown","sendRotate","call","onKeyDown","onKeyUp","getTouchLine","buttonNode","worldPosition","getNodeArrMaxCol","getNodeArrMinCol","row","col","nextBlock","showNextShape","nextNode","trimSizeJson","generateNext","parentNode","setPrefabPosition","prefab","createPrefab","prefabNode","instantiate","createRandom","min","max","start","update","dt","onSlide","onGameSlide","column","slidePosition","gameSlidePosition","moveRight","moveLeft","map","sendJsonData","color","toString","console","push","os","OS_ANDROID","sendJsonData1","sendJsonData0","sendJsonData2","updatePrefatY","sendDataToServer","getChildByName","loadScene","isNetWork","checkNodeArr","canRemove","waitQueue","addWillDeleteArr","willDeleteArr","directorFind","typeArr","isCommonType","leftRow","leftCol","remove","deleteNodeFromParent","waitDownArr","upFindNodes","addScore","waitQueueLength","CheckIsDown","down","CheckIsLeft","leftMove","CheckIsRight","rightMove","rotate","updateMap","onDestroy","pause"],"mappings":"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","file":"FightGame3.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Scripts\\FightGame3","sourcesContent":["var Game3 = require(\"../game3/game\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n            //预制体数组\r\n        prefabArr : {\r\n            default : [],\r\n            type    : [cc.Prefab],\r\n        },\r\n        girdSize : 20,\r\n        backPrefab  : {\r\n            default : null,\r\n            type    : cc.Prefab,\r\n        },\r\n        scoreLabel : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //下一个形状显示区域节点\r\n        nextShape   : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //联网版的时候是对手信息\r\n        rivalInfoNode : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //下落按钮\r\n        downButton  : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        // //单机版的时候是下下个方格状态\r\n        // next2 : {\r\n        //     default : null,\r\n        //     type    : cc.Node,\r\n        // },\r\n        //gameover标签\r\n        // gameBye : {\r\n        //     default : null,\r\n        //     type    : cc.Node,\r\n        // },\r\n        //滑动按钮\r\n        slideButton : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        rotateButton : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //遮罩\r\n        mask : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //结束菜单\r\n        pauseMenu : {\r\n            default   : null,\r\n            type      : cc.Node,\r\n        },\r\n        //游戏结束菜单\r\n        overMenu  : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        overAnimation : {\r\n            default : null,\r\n            type    : cc.Node,\r\n        },\r\n        //左移右移节点\r\n        // leftAndRight : {\r\n        //     default : null,\r\n        //     type    : cc.Node,\r\n        // },\r\n        gameSlide : cc.Node,\r\n        nickName  : cc.Node,\r\n        rivalName : cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.normalSpeed = 0.7,\r\n        this.quickSpeed  = 0.07,\r\n        this.up = 15;\r\n        this.lr = 13;\r\n        cc.log(\"当前游戏是否是处于暂停状态\"+cc.director.isPaused());\r\n        if(cc.director.isPaused()){\r\n            cc.director.resume();\r\n        }\r\n        this.overAnimation.active = false;\r\n        //发给服务器的数据\r\n        this.jsonMsgToServer = {\r\n            tag1            : 9,\r\n            score           : \"\",\r\n            type            : \"\",\r\n            state1          : \"\",\r\n            changeMapList1  : [],\r\n            removeMapList1  : 0,\r\n            nMapRow         : \"\",\r\n            nMapCol         : \"\",\r\n            loading1        : \"\",\r\n        };\r\n        //消除之后待下落数组的集合\r\n        this.nodeWidth = this.node.width;\r\n        this.nodeHeight = this.node.height;\r\n        cc.log(\"this.nodeWidth is \" + this.nodeWidth + \"this.nodeHeight is \" + this.nodeHeight);\r\n        //定义消除次数\r\n        this.eliminateCount = 0;\r\n        //定义得分\r\n        this.score = 0;\r\n        //背景二位数组\r\n        this.backGroundArr = null;\r\n        //形状集合二维数组,将每次生成的形状添加到二维数组里面\r\n        // this.shapeArr = [];\r\n        this.time = 0;\r\n        //创建背景网格\r\n        this.initMap(this.up,this.lr,this.backPrefab,12,6);\r\n        //存放每次生成的预制体数组即是活动的条\r\n        this.nodeArr = this.createShape(this.node);\r\n        // //生成下一个形状\r\n        this.createNext();\r\n        cc.log(\"this.nodeArr is \" + this.nodeArr);\r\n        // this.columnLocation();\r\n        //创建下一个旋转体\r\n        this.gameOver = false;\r\n        // this.nextShape = new Shape(this.nextShape,0,0);\r\n        // this.gameBye.active = false;\r\n        //当前条是否还可以改变状态\r\n        this.canChangeStatu = true;\r\n        //状态机的状态\r\n        this.iState = 0;\r\n        //定义一个状态标志\r\n        /**\r\n         * cover = 0 封面\r\n         * paly = 2; 游戏\r\n         * remove = 3;消除\r\n         * over = 4;结束游戏\r\n         * Menu 菜单\r\n         */\r\n        this.xltime = this.normalSpeed;\r\n        this.cishu = 0;\r\n        Array.prototype.contain = function(shape){\r\n            if(shape != undefined){\r\n                for(var i = 0;i<this.length;i++){\r\n                    if(this[i].x === shape.x && this[i].y === shape.y && this[i].getComponent(\"Stone\").type === shape.getComponent(\"Stone\").type){\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        //下落按钮监听\r\n        this.downButton.on(\"touchstart\",function(){\r\n            this.downButton.children[0].opacity = 120;\r\n            this.xltime = this.quickSpeed;\r\n        }.bind(this));\r\n        this.downButton.on(\"touchend\",function(){\r\n            this.downButton.children[0].opacity = 0;\r\n            this.xltime = this.normalSpeed;\r\n        }.bind(this));\r\n        //注册监听事件\r\n        this.registerKeyBoard();\r\n        // var rotateAction = cc.rotateBy(3,360).easing(cc.easeCubicActionOut());\r\n        // var rf = cc.repeatForever(rotateAction);\r\n        // this.rotateButton.runAction(rf);\r\n        //游戏开始不显示遮罩\r\n        this.mask.active = false;\r\n        //开始时候暂停菜单不显示\r\n        this.pauseMenu.active = false;\r\n        //消除的次数\r\n        this.removeTime = 0;\r\n\r\n        //游戏结束菜单不显示\r\n        this.overMenu.active = false;\r\n        //游戏结束计时\r\n        this.overCost = 0;\r\n        //滑动按钮时间间隔，到达那个事件间隔计算第二次触摸所对应的列数\r\n        this.index = 0;\r\n        if(cc.sys.isNative){\r\n            this.nickName.getComponent(cc.Label).string = cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").nameUser;\r\n            //发送数据到服务器\r\n            cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg({\"tag1\":10,\"type\":\"\",\"score\":cc.find(\"PebmanentNode\").getComponent(\"UserInfo\").nUserScore,\"nMapRow\":\"\",\"nMapCol\":\"\",\"loading1\":1});\r\n        }\r\n        //触屏的当前列\r\n        this.nCol = 0;\r\n        this.rightDirection = false;\r\n        this.leftDirection = false;\r\n        this.slideStart = 0;\r\n        //对手是否触底\r\n        this.rivalTouchBarry = false;\r\n        //调用消除方法的次数\r\n        this.invokeRemoveTime = 0;\r\n        //是不是向服务器发送向左移动的信息\r\n        this.sendLeft = false;\r\n        //是不是向服务器发送向右移动的信息\r\n        this.sendRight = false;\r\n        //是不是向服务器发送向下移动的信息\r\n        this.sendDown = false;\r\n        //是不是向服务器发送旋转的信息\r\n        this.sendRotate = false;\r\n    },\r\n    registerKeyBoard : function(){\r\n        Game3.prototype.registerKeyBoard.call(this);\r\n    },\r\n    onKeyDown : function(){\r\n        Game3.prototype.onKeyDown.call(this);\r\n    },\r\n    onKeyUp   : function(){\r\n        Game3.prototype.onKeyUp.call(this);\r\n    },\r\n    //获得触点坐标位置\r\n    getTouchLine : function(buttonNode,worldPosition){\r\n        return Game3.prototype.getTouchLine.call(this,buttonNode,worldPosition);\r\n    },\r\n    //获得节点数组中最大的列\r\n    getNodeArrMaxCol : function(){\r\n        return Game3.prototype.getNodeArrMaxCol.call(this);\r\n    },\r\n    //获得节点数组中最小的列\r\n    getNodeArrMinCol : function(){\r\n        return Game3.prototype.getNodeArrMinCol.call(this);\r\n    },\r\n    //this.up,this.lr,this.backPrefab,12,6\r\n    initMap : function(up,lr,backPrefab,row,col){\r\n        Game3.prototype.initMap.call(this,up,lr,backPrefab,row,col);\r\n    },\r\n    //生成预制体\r\n    createShape : function(node){\r\n        return Game3.prototype.createShape.call(this,node);\r\n    },\r\n    createNext : function(){\r\n        this.nextBlock = this.createShape(this.node);\r\n        //显示下一个形状\r\n        this.showNextShape(this.nextBlock,this.nextShape);\r\n    },\r\n    showNextShape : function(nextBlock,nextNode){\r\n        var trimSizeJson = {\r\n            width  : 100,\r\n            height : 100,\r\n        }\r\n        Game3.prototype.showNextShape.call(this,nextBlock,nextNode,trimSizeJson);\r\n    },\r\n    generateNext : function(parentNode){\r\n        return this.createShape(parentNode);\r\n    },\r\n    /**\r\n    @param prefab:将要生成预制节点的预制体\r\n    @param x     :将要生成预制节点的x坐标\r\n    @param y     :将要生成预制节点的y坐标\r\n    @param parentNode : 生成的预制节点的父节点\r\n    @param trimSizeJson : 对预制体进行裁减的时候的json对象\r\n    */\r\n    setPrefabPosition : function(prefab,x,y,parentNode,trimSizeJson){\r\n        return Game3.prototype.setPrefabPosition.call(this,prefab,x,y,parentNode,trimSizeJson);\r\n    },\r\n    createPrefab : function(prefab){\r\n        var prefabNode = cc.instantiate(prefab);\r\n        return prefabNode;\r\n    },\r\n    createRandom : function(min,max){\r\n        return Game3.prototype.createRandom.call(this,min,max);\r\n    },\r\n    start () {\r\n\r\n    },\r\n    update (dt) {\r\n        if(this.onSlide || this.onGameSlide){\r\n            this.index += dt;\r\n            // cc.log(\"this.slidePosition is \" + this.slidePosition.x);\r\n            // if(this.index === dt){\r\n            //     this.column1 = this.getTouchLine(this.slidePosition);\r\n            // }\r\n            // if(this.index >= 0.3){\r\n            //     this.column2 = this.getTouchLine(this.slidePosition);\r\n            //     this.index = 0;\r\n            // }\r\n            if(this.onSlide){\r\n                var column = this.getTouchLine(this.slideButton,this.slidePosition);\r\n                //当用的是滑屏的时候将空节点的滑动状态改为false\r\n                this.onSlide = false;\r\n            }else{\r\n                var column = this.getTouchLine(this.gameSlide,this.gameSlidePosition);\r\n                this.onGameSlide = false;\r\n            }\r\n            //如果当前列比节点数组中最大列还大的话就右移\r\n            if(column > this.getNodeArrMaxCol()){\r\n                //右移\r\n                this.moveRight();\r\n            }else if(column < this.getNodeArrMinCol()){\r\n                //左移\r\n                this.moveLeft();\r\n            }\r\n        }\r\n        //如果游戏结束了就不在进行下落\r\n        if(!this.gameOver){\r\n            this.time += dt;\r\n            if(this.cishu === 0 && this.xltime < this.normalSpeed){\r\n                //如果重新生成一个形状的话就将下落的速度改为this.normalSpeed\r\n                this.xltime = this.normalSpeed;\r\n            }\r\n            if(this.time > this.xltime){\r\n                if(this.cishu < 3){\r\n                    if(this.cishu === 0){\r\n                        if(this.map[0][this.nodeArr[2].getComponent(\"Stone\").col] != 1){\r\n                            this.nodeArr[2].active = true;\r\n                            let sendJsonData = {\r\n                                row   : 0,\r\n                                col   : this.nodeArr[2].getComponent(\"Stone\").col,\r\n                                color : this.nodeArr[2].getComponent(\"Stone\").type.toString(),\r\n                            }\r\n                            console.log(\"this.jsonMsgToServer is \" + this.jsonMsgToServer);\r\n                            this.jsonMsgToServer.changeMapList1.push(sendJsonData);\r\n                            console.log(\"sendJsonData is \",sendJsonData);\r\n                            //发送数据到服务器\r\n                            if(cc.sys.os === cc.sys.OS_ANDROID){\r\n                                cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n                            }\r\n                            this.jsonMsgToServer.changeMapList1 = [];\r\n                        }\r\n                        else\r\n                            this.gameOver = true;    \r\n                    }else if(this.cishu === 1){\r\n                        if(this.map[1][this.nodeArr[1].getComponent(\"Stone\").col] != 1){\r\n                            this.nodeArr[2].y = this.backGroundArr[1][this.nodeArr[1].getComponent(\"Stone\").col].y;\r\n                            this.nodeArr[2].getComponent(\"Stone\").row = 1;\r\n                            this.nodeArr[1].active = true;\r\n                            this.nodeArr[1].y = this.backGroundArr[0][this.nodeArr[0].getComponent(\"Stone\").col].y;\r\n                            this.nodeArr[1].getComponent(\"Stone\").row = 0;\r\n\r\n                            let sendJsonData1 = {\r\n                                row : 1,\r\n                                col : this.nodeArr[2].getComponent(\"Stone\").col,\r\n                                color : this.nodeArr[2].getComponent(\"Stone\").type.toString(),\r\n                            }\r\n                            let sendJsonData0 = {\r\n                                row : 0,\r\n                                col : this.nodeArr[1].getComponent(\"Stone\").col,\r\n                                color : this.nodeArr[1].getComponent(\"Stone\").type.toString(),\r\n                            }\r\n                            this.jsonMsgToServer.changeMapList1.push(sendJsonData1);\r\n                            this.jsonMsgToServer.changeMapList1.push(sendJsonData0);\r\n                            console.log(sendJsonData1);\r\n                            console.log(sendJsonData0);\r\n                            if(cc.sys.os === cc.sys.OS_ANDROID){\r\n                                cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n                            }\r\n                            this.jsonMsgToServer.changeMapList1 = [];\r\n                        }else{\r\n                            this.gameOver = true;\r\n                        }\r\n                    }else if(this.cishu === 2){\r\n                        if(this.map[2][this.nodeArr[1].getComponent(\"Stone\").col] != 1){\r\n                            this.nodeArr[2].y = this.backGroundArr[2][this.nodeArr[1].getComponent(\"Stone\").col].y;\r\n                            this.nodeArr[2].getComponent(\"Stone\").row = 2;\r\n    \r\n                            this.nodeArr[1].y = this.backGroundArr[1][this.nodeArr[0].getComponent(\"Stone\").col].y;\r\n                            this.nodeArr[1].getComponent(\"Stone\").row = 1;\r\n    \r\n                            this.nodeArr[0].active = true;\r\n                            this.nodeArr[0].getComponent(\"Stone\").row = 0;\r\n                            let sendJsonData2 = {\r\n                                row     : 2,\r\n                                col     : this.nodeArr[2].getComponent(\"Stone\").col,\r\n                                color   : this.nodeArr[2].getComponent(\"Stone\").type.toString(),\r\n                            };\r\n                            let sendJsonData1 = {\r\n                                row     : 1,\r\n                                col     : this.nodeArr[1].getComponent(\"Stone\").col,\r\n                                color   : this.nodeArr[1].getComponent(\"Stone\").type.toString(),\r\n                            };\r\n                            let sendJsonData0 = {\r\n                                row     : 0,\r\n                                col     : this.nodeArr[0].getComponent(\"Stone\").col,\r\n                                color   : this.nodeArr[0].getComponent(\"Stone\").type.toString(),\r\n                            }\r\n                            this.jsonMsgToServer.changeMapList1.push(sendJsonData2);\r\n                            this.jsonMsgToServer.changeMapList1.push(sendJsonData1);\r\n                            this.jsonMsgToServer.changeMapList1.push(sendJsonData0);\r\n                            console.log(sendJsonData2);\r\n                            console.log(sendJsonData1);\r\n                            console.log(sendJsonData0);\r\n                            if(cc.sys.os === cc.sys.OS_ANDROID){\r\n                                cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n                            }\r\n                            this.jsonMsgToServer.changeMapList1 = [];\r\n                        }else{\r\n                            this.gameOver = true;\r\n                        }\r\n                        \r\n                    }\r\n                    this.cishu++;\r\n                }else{\r\n                    // this.cishu = 0;\r\n                    this.updatePrefatY(this.nodeArr,true);\r\n                }\r\n                this.time = 0;\r\n            }\r\n            //左移动的时候将数据发送到服务器\r\n            if(this.sendDown){\r\n                if(cc.sys.os === cc.sys.OS_ANDROID){\r\n                    cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n                    console.log(\"=================下落发送数据到服务器完毕==================\");\r\n                    //发送完该数据后将该数组置空\r\n                    this.jsonMsgToServer.changeMapList1 = [];\r\n                    //发送完毕关闭该开关\r\n                    this.sendDown = false;\r\n                }\r\n            }\r\n            //发送向左移动的数据\r\n            if(this.sendLeft){\r\n                if(cc.sys.os === cc.sys.OS_ANDROID){\r\n                    console.log(\"================发送数据开始================\");\r\n                    cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n                    console.log(\"================发送数据结束================\");\r\n                    this.jsonMsgToServer.changeMapList1 = [];\r\n                    this.sendLeft = false;\r\n                }\r\n            }\r\n            //发送向右移动的数据\r\n            if(this.sendRight){\r\n                if(cc.sys.os === cc.sys.OS_ANDROID){\r\n                    cc.find(\"PebmanentNode\").getComponent(\"GetServer\").SendLongMsg(this.jsonMsgToServer);\r\n                    console.log(\"================发送数据结束================\");\r\n                    this.jsonMsgToServer.changeMapList1 = [];\r\n                    this.sendRight = false;\r\n                }\r\n            }\r\n            //发送旋转的相关数据\r\n            if(this.sendRotate){\r\n                if(cc.sys.os === cc.sys.OS_ANDROID){\r\n                    console.log(\"=============发送数据到服务器==============\");\r\n                    this.sendDataToServer(this.jsonMsgToServer);\r\n                    this.jsonMsgToServer.changeMapList1 = [];\r\n                    this.sendRotate = false;\r\n                }\r\n            }\r\n        }else{\r\n            this.overMenu.active = true;\r\n            //显示分数\r\n            this.overMenu.getChildByName(\"scoreValue\").getComponent(cc.Label).string = this.score;\r\n            this.overCost += dt;\r\n            // //暂停游戏\r\n            // cc.director.pause();\r\n            if(this.overCost >= 4){\r\n                //恢复游戏主逻辑\r\n                cc.director.resume();\r\n                cc.director.loadScene(\"OneChoose\");\r\n                this.overCost = 0;\r\n            }\r\n        }\r\n    },\r\n    //网络版的加测下落\r\n    updatePrefatY : function(nodeArr,isNetWork){\r\n        Game3.prototype.updatePrefatY.call(this,nodeArr,isNetWork);\r\n    },\r\n    //检查节点是否可以消除\r\n    checkNodeArr : function(nodeArr,isNetWork){\r\n        return Game3.prototype.checkNodeArr.call(this,nodeArr,isNetWork);\r\n    },\r\n    //检查一个节点数组是否可以进行消除\r\n    canRemove : function(nodeArr,waitQueue){\r\n        return Game3.prototype.canRemove.call(this,nodeArr,waitQueue);\r\n    },\r\n    //添加待消节点到待消节点到待消队列里面\r\n    addWillDeleteArr : function(node,willDeleteArr){\r\n        Game3.prototype.addWillDeleteArr.call(this,node,willDeleteArr);\r\n    },\r\n    //四个方向寻找看看是否和自己的类型相同\r\n    directorFind : function(typeArr,row,col,i,type,node){\r\n        Game3.prototype.directorFind.call(this,typeArr,row,col,i,type,node);\r\n    },\r\n    //看看周围的加点是否和自己的类型相同\r\n    isCommonType : function(leftRow,leftCol,type){\r\n        return Game3.prototype.isCommonType.call(this,leftRow,leftCol,type);\r\n    },\r\n    //消除方法\r\n    remove : function(waitQueue,removeTime,isNetWork){\r\n        return Game3.prototype.remove.call(this,waitQueue,removeTime,isNetWork);\r\n    },\r\n    //从节点树种删除待消节点\r\n    deleteNodeFromParent : function(waitQueue,waitDownArr){\r\n        Game3.prototype.deleteNodeFromParent.call(this,waitQueue,waitDownArr);\r\n    },\r\n    //向上查找待消节点上的所有节点\r\n    upFindNodes:function(row,col){\r\n        return Game3.prototype.upFindNodes.call(this,row,col);\r\n    },\r\n    addScore :function(waitQueueLength){\r\n        Game3.prototype.addScore.call(this,waitQueueLength);\r\n    },\r\n    //检查是否可以下落\r\n    CheckIsDown   : function(nodeArr){\r\n        return Game3.prototype.CheckIsDown.call(this,nodeArr);\r\n    },\r\n    //=================下落,左移右移代码部分开始==================\r\n    down : function(nodeArr,isNetWork){\r\n        //可以向服务器发送下降信息\r\n        this.sendDown = true;\r\n        Game3.prototype.down.call(this,nodeArr,isNetWork);\r\n    },\r\n    //左移方法\r\n    moveLeft : function(){\r\n        Game3.prototype.moveLeft.call(this,true);\r\n    },\r\n    //检查是否能够向左移动\r\n    CheckIsLeft : function(){\r\n        return Game3.prototype.CheckIsLeft.call(this);\r\n    },\r\n    //左移方法\r\n    leftMove : function(node,isNetWork){\r\n        this.sendLeft = true;\r\n        Game3.prototype.leftMove.call(this,node,isNetWork);\r\n    },\r\n    //右移方法\r\n    moveRight : function(){\r\n        Game3.prototype.moveRight.call(this);\r\n    },\r\n    //检查是否可以向右移动\r\n    CheckIsRight : function(){\r\n        return Game3.prototype.CheckIsRight.call(this);\r\n    },\r\n    //右移操作\r\n    rightMove : function(node,isNetWork){\r\n        this.sendRight = true;\r\n        Game3.prototype.rightMove.call(this,node,isNetWork);\r\n    },\r\n    //旋转操作\r\n    rotate : function(){\r\n        this.sendRotate = true;\r\n        Game3.prototype.rotate.call(this,true);\r\n    },\r\n    //====================下落，左移右移,旋转代码部分结束=========================\r\n    //更新地图信息\r\n    updateMap : function(nodeArr){\r\n        Game3.prototype.updateMap.call(this,nodeArr);\r\n    },\r\n    onDestroy (){\r\n        Game3.prototype.onDestroy.call(this);\r\n    },\r\n    //暂停游戏方法\r\n    pause: function(){\r\n        Game3.prototype.pause.call(this);\r\n    }\r\n});\r\n"]}